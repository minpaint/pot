# Generated by Django 5.0.14 on 2025-12-08 08:26

import django.db.models.deletion
from django.conf import settings
from django.db import migrations, models


class Migration(migrations.Migration):

    dependencies = [
        ('deadline_control', '0019_add_instruction_journal_recipients'),
        ('directory', '0049_add_email_recipient_system'),
        migrations.swappable_dependency(settings.AUTH_USER_MODEL),
    ]

    operations = [
        migrations.AlterField(
            model_name='emailsettings',
            name='instruction_journal_recipients',
            field=models.TextField(blank=True, default='', help_text='Email –∞–¥—Ä–µ—Å–∞ –¥–ª—è —Ä–∞—Å—Å—ã–ª–∫–∏ –æ–±—Ä–∞–∑—Ü–æ–≤ –∂—É—Ä–Ω–∞–ª–æ–≤ –ø–æ–≤—Ç–æ—Ä–Ω—ã—Ö –∏–Ω—Å—Ç—Ä—É–∫—Ç–∞–∂–µ–π. –ü–æ –æ–¥–Ω–æ–º—É –Ω–∞ —Å—Ç—Ä–æ–∫—É. –ï—Å–ª–∏ –ø—É—Å—Ç–æ, –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è –¢–û–õ–¨–ö–û –ø–æ–ª—É—á–∞—Ç–µ–ª–∏ –∏–∑ –ø–æ–¥—Ä–∞–∑–¥–µ–ª–µ–Ω–∏–π (SubdivisionEmail + –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω—ã–µ –∑–∞ –û–¢), –ë–ï–ó –æ–±—â–∏—Ö –ø–æ–ª—É—á–∞—Ç–µ–ª–µ–π.', verbose_name='Email –ø–æ–ª—É—á–∞—Ç–µ–ª–µ–π (–∂—É—Ä–Ω–∞–ª—ã –∏–Ω—Å—Ç—Ä—É–∫—Ç–∞–∂–µ–π)'),
        ),
        migrations.CreateModel(
            name='InstructionJournalSendLog',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('briefing_date', models.DateField(help_text='–î–∞—Ç–∞ –ø—Ä–æ–≤–µ–¥–µ–Ω–∏—è –ø–æ–≤—Ç–æ—Ä–Ω–æ–≥–æ –∏–Ω—Å—Ç—Ä—É–∫—Ç–∞–∂–∞', verbose_name='–î–∞—Ç–∞ –∏–Ω—Å—Ç—Ä—É–∫—Ç–∞–∂–∞')),
                ('briefing_type', models.CharField(default='–ü–æ–≤—Ç–æ—Ä–Ω—ã–π', help_text='–ü–æ–≤—Ç–æ—Ä–Ω—ã–π, –í–Ω–µ–ø–ª–∞–Ω–æ–≤—ã–π –∏ —Ç.–¥.', max_length=100, verbose_name='–í–∏–¥ –∏–Ω—Å—Ç—Ä—É–∫—Ç–∞–∂–∞')),
                ('briefing_reason', models.TextField(blank=True, default='', help_text='–ü—Ä–∏—á–∏–Ω–∞ –ø—Ä–æ–≤–µ–¥–µ–Ω–∏—è –∏–Ω—Å—Ç—Ä—É–∫—Ç–∞–∂–∞', verbose_name='–ü—Ä–∏—á–∏–Ω–∞ –ø—Ä–æ–≤–µ–¥–µ–Ω–∏—è')),
                ('total_subdivisions', models.IntegerField(default=0, help_text='–û–±—â–µ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–æ–¥—Ä–∞–∑–¥–µ–ª–µ–Ω–∏–π –≤ –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏–∏', verbose_name='–í—Å–µ–≥–æ –ø–æ–¥—Ä–∞–∑–¥–µ–ª–µ–Ω–∏–π')),
                ('successful_count', models.IntegerField(default=0, verbose_name='–£—Å–ø–µ—à–Ω—ã—Ö –æ—Ç–ø—Ä–∞–≤–æ–∫')),
                ('failed_count', models.IntegerField(default=0, verbose_name='–û—à–∏–±–æ–∫ –æ—Ç–ø—Ä–∞–≤–∫–∏')),
                ('skipped_count', models.IntegerField(default=0, help_text='–ü—Ä–æ–ø—É—â–µ–Ω–æ (–Ω–µ—Ç –ø–æ–ª—É—á–∞—Ç–µ–ª–µ–π –∏–ª–∏ —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤)', verbose_name='–ü—Ä–æ–ø—É—â–µ–Ω–æ')),
                ('status', models.CharField(choices=[('in_progress', '–í –ø—Ä–æ—Ü–µ—Å—Å–µ'), ('completed', '–ó–∞–≤–µ—Ä—à–µ–Ω–æ —É—Å–ø–µ—à–Ω–æ'), ('partial', '–ó–∞–≤–µ—Ä—à–µ–Ω–æ —á–∞—Å—Ç–∏—á–Ω–æ'), ('failed', '–û—à–∏–±–∫–∞')], default='in_progress', max_length=20, verbose_name='–°—Ç–∞—Ç—É—Å')),
                ('created_at', models.DateTimeField(auto_now_add=True, verbose_name='–î–∞—Ç–∞ –∑–∞–ø—É—Å–∫–∞')),
                ('updated_at', models.DateTimeField(auto_now=True, verbose_name='–î–∞—Ç–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è')),
                ('initiated_by', models.ForeignKey(null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='initiated_instruction_sends', to=settings.AUTH_USER_MODEL, verbose_name='–ò–Ω–∏—Ü–∏–∞—Ç–æ—Ä')),
                ('organization', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='instruction_send_logs', to='directory.organization', verbose_name='–û—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏—è')),
            ],
            options={
                'verbose_name': 'üìß –õ–æ–≥ –º–∞—Å—Å–æ–≤–æ–π —Ä–∞—Å—Å—ã–ª–∫–∏',
                'verbose_name_plural': 'üìß –õ–æ–≥–∏ –º–∞—Å—Å–æ–≤—ã—Ö —Ä–∞—Å—Å—ã–ª–æ–∫',
                'ordering': ['-created_at'],
            },
        ),
        migrations.CreateModel(
            name='InstructionJournalSendDetail',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('status', models.CharField(choices=[('success', '‚úÖ –û—Ç–ø—Ä–∞–≤–ª–µ–Ω–æ'), ('failed', '‚ùå –û—à–∏–±–∫–∞'), ('skipped', '‚è© –ü—Ä–æ–ø—É—â–µ–Ω–æ')], max_length=20, verbose_name='–°—Ç–∞—Ç—É—Å')),
                ('recipients', models.TextField(default='[]', help_text='JSON —Å–ø–∏—Å–æ–∫ email –∞–¥—Ä–µ—Å–æ–≤: ["a@test.com", "b@test.com"]', verbose_name='–ü–æ–ª—É—á–∞—Ç–µ–ª–∏ (JSON)')),
                ('recipients_count', models.IntegerField(default=0, verbose_name='–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–æ–ª—É—á–∞—Ç–µ–ª–µ–π')),
                ('employees_count', models.IntegerField(default=0, help_text='–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤ –≤ —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω–Ω–æ–º –¥–æ–∫—É–º–µ–Ω—Ç–µ', verbose_name='–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤')),
                ('email_subject', models.CharField(blank=True, default='', max_length=500, verbose_name='–¢–µ–º–∞ –ø–∏—Å—å–º–∞')),
                ('skip_reason', models.CharField(blank=True, choices=[('no_recipients', '–ù–µ—Ç –ø–æ–ª—É—á–∞—Ç–µ–ª–µ–π'), ('no_employees', '–ù–µ—Ç —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤ —Å –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è–º–∏'), ('doc_generation_failed', '–û—à–∏–±–∫–∞ –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –¥–æ–∫—É–º–µ–Ω—Ç–∞'), ('template_not_found', '–ù–µ –Ω–∞–π–¥–µ–Ω —à–∞–±–ª–æ–Ω –ø–∏—Å—å–º–∞'), ('email_send_failed', '–û—à–∏–±–∫–∞ –æ—Ç–ø—Ä–∞–≤–∫–∏ email')], default='', max_length=50, verbose_name='–ü—Ä–∏—á–∏–Ω–∞ –ø—Ä–æ–ø—É—Å–∫–∞')),
                ('error_message', models.TextField(blank=True, default='', verbose_name='–¢–µ–∫—Å—Ç –æ—à–∏–±–∫–∏')),
                ('sent_at', models.DateTimeField(blank=True, help_text='–î–∞—Ç–∞ –∏ –≤—Ä–µ–º—è —Ñ–∞–∫—Ç–∏—á–µ—Å–∫–æ–π –æ—Ç–ø—Ä–∞–≤–∫–∏ –ø–∏—Å—å–º–∞', null=True, verbose_name='–î–∞—Ç–∞ –æ—Ç–ø—Ä–∞–≤–∫–∏')),
                ('created_at', models.DateTimeField(auto_now_add=True, verbose_name='–î–∞—Ç–∞ —Å–æ–∑–¥–∞–Ω–∏—è')),
                ('subdivision', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='instruction_send_details', to='directory.structuralsubdivision', verbose_name='–ü–æ–¥—Ä–∞–∑–¥–µ–ª–µ–Ω–∏–µ')),
                ('send_log', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='details', to='deadline_control.instructionjournalsendlog', verbose_name='–õ–æ–≥ —Ä–∞—Å—Å—ã–ª–∫–∏')),
            ],
            options={
                'verbose_name': 'üìã –î–µ—Ç–∞–ª—å –æ—Ç–ø—Ä–∞–≤–∫–∏',
                'verbose_name_plural': 'üìã –î–µ—Ç–∞–ª–∏ –æ—Ç–ø—Ä–∞–≤–æ–∫',
                'ordering': ['subdivision__name'],
            },
        ),
        migrations.AddIndex(
            model_name='instructionjournalsendlog',
            index=models.Index(fields=['organization', '-created_at'], name='deadline_co_organiz_d2bb47_idx'),
        ),
        migrations.AddIndex(
            model_name='instructionjournalsendlog',
            index=models.Index(fields=['initiated_by', '-created_at'], name='deadline_co_initiat_64188e_idx'),
        ),
        migrations.AddIndex(
            model_name='instructionjournalsendlog',
            index=models.Index(fields=['status'], name='deadline_co_status_abe4d5_idx'),
        ),
        migrations.AddIndex(
            model_name='instructionjournalsenddetail',
            index=models.Index(fields=['send_log', 'status'], name='deadline_co_send_lo_922a23_idx'),
        ),
        migrations.AddIndex(
            model_name='instructionjournalsenddetail',
            index=models.Index(fields=['subdivision'], name='deadline_co_subdivi_02c90d_idx'),
        ),
    ]
