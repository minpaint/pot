{% extends "admin/base_site.html" %}
{% load static %}

{% block title %}–í—ã–±–æ—Ä –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤ –¥–ª—è {{ action_title }}{% endblock %}

{% block extrahead %}
    {{ block.super }}
    <style>
        .document-types-container {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
            gap: 10px;
            margin-bottom: 20px;
        }

        .document-type-item {
            background: #f8f9fa;
            border: 1px solid #dee2e6;
            border-radius: 4px;
            padding: 10px;
        }

        .document-type-item:hover {
            background: #e9ecef;
        }

        .submit-btn-container {
            margin-top: 20px;
            padding-top: 20px;
            border-top: 1px solid #dee2e6;
        }

        .hiring-info {
            background: #e7f3ff;
            border-left: 4px solid #2196F3;
            padding: 15px;
            margin-bottom: 20px;
            border-radius: 4px;
        }

        .hiring-info strong {
            display: block;
            margin-bottom: 5px;
        }

        .alert-info-custom {
            background-color: #d1ecf1;
            border-color: #bee5eb;
            color: #0c5460;
            padding: 10px;
            border-radius: 4px;
            margin-bottom: 15px;
        }

        .btn-primary {
            background-color: #417690;
            border-color: #417690;
        }

        .btn-primary:hover {
            background-color: #356a80;
            border-color: #356a80;
        }
    </style>
{% endblock %}

{% block breadcrumbs %}
<div class="breadcrumbs">
    <a href="{% url 'admin:index' %}">–ì–ª–∞–≤–Ω–∞—è</a>
    &rsaquo; <a href="{% url 'admin:directory_employeehiring_changelist' %}">–ü—Ä–∏—ë–º –Ω–∞ —Ä–∞–±–æ—Ç—É</a>
    &rsaquo; {{ action_title }}
</div>
{% endblock %}

{% block content %}
<h1>{{ action_title }}</h1>

{% if messages %}
    {% for message in messages %}
        <div class="alert alert-{% if message.tags %}{{ message.tags }}{% else %}info{% endif %}" role="alert">
            {{ message }}
        </div>
    {% endfor %}
{% endif %}

{% if hirings|length == 1 %}
    {% with hiring=hirings.0 %}
    <div class="hiring-info">
        <strong>üë§ {{ hiring.employee.full_name_nominative }}</strong>
        <div>–î–æ–ª–∂–Ω–æ—Å—Ç—å: {{ hiring.position.position_name }}</div>
        <div>–û—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏—è: {{ hiring.organization.short_name_ru }}</div>
        {% if hiring.subdivision %}
        <div>–ü–æ–¥—Ä–∞–∑–¥–µ–ª–µ–Ω–∏–µ: {{ hiring.subdivision.name }}</div>
        {% endif %}
        {% if hiring.department %}
        <div>–û—Ç–¥–µ–ª: {{ hiring.department.name }}</div>
        {% endif %}
        <div>–î–∞—Ç–∞ –ø—Ä–∏–µ–º–∞: {{ hiring.hiring_date|date:"d.m.Y" }}</div>
    </div>
    {% endwith %}
{% else %}
    <div class="hiring-info">
        <strong>üìã –í—ã–±—Ä–∞–Ω–æ –∑–∞–ø–∏—Å–µ–π –æ –ø—Ä–∏–µ–º–µ: {{ hirings|length }}</strong>
        {% for hiring in hirings %}
        <div style="margin-left: 20px; margin-top: 5px;">
            {{ forloop.counter }}. {{ hiring.employee.full_name_nominative }} ‚Äî {{ hiring.position.position_name }}
        </div>
        {% endfor %}
    </div>
{% endif %}

<form method="post" action="">
    {% csrf_token %}

    {% for hiring_id in hiring_ids %}
    <input type="hidden" name="hiring_ids" value="{{ hiring_id }}">
    {% endfor %}
    <input type="hidden" name="action" value="{{ action }}">

    <h3>üìÑ –í—ã–±–µ—Ä–∏—Ç–µ —Ç–∏–ø—ã –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤</h3>

    <div class="document-types-container">
        {% for value, text in document_types_choices %}
        <div class="document-type-item">
            <label>
                <input type="checkbox" name="document_types" value="{{ value }}"
                       {% if value in default_document_types %}checked{% endif %}>
                {{ text }}
            </label>
        </div>
        {% endfor %}
    </div>

    {% if action == 'send' %}
    <div class="alert-info-custom">
        <strong>‚ÑπÔ∏è –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è:</strong> –î–æ–∫—É–º–µ–Ω—Ç—ã –±—É–¥—É—Ç –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω—ã –Ω–∞ email –∞–¥—Ä–µ—Å–∞, –Ω–∞—Å—Ç—Ä–æ–µ–Ω–Ω—ã–µ –¥–ª—è –ø–æ–¥—Ä–∞–∑–¥–µ–ª–µ–Ω–∏–π –∏ –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω—ã—Ö –∑–∞ –æ—Ö—Ä–∞–Ω—É —Ç—Ä—É–¥–∞.
    </div>
    {% endif %}

    <div class="submit-btn-container">
        {% if action == 'generate' %}
        <button type="submit" class="btn btn-primary">
            <i class="icon-download"></i> –°–∫–∞—á–∞—Ç—å –¥–æ–∫—É–º–µ–Ω—Ç—ã
        </button>
        {% else %}
        <button type="submit" class="btn btn-primary">
            <i class="icon-mail-forward"></i> –û—Ç–ø—Ä–∞–≤–∏—Ç—å –¥–æ–∫—É–º–µ–Ω—Ç—ã
        </button>
        {% endif %}

        <a href="{% url 'admin:directory_employeehiring_changelist' %}" class="btn btn-secondary" style="margin-left: 10px;">
            –û—Ç–º–µ–Ω–∞
        </a>
    </div>
</form>

{% endblock %}
