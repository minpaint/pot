# üìß –°–∏—Å—Ç–µ–º–∞ Email-—Ä–∞—Å—Å—ã–ª–∫–∏

## –û–ø–∏—Å–∞–Ω–∏–µ

–°–∏—Å—Ç–µ–º–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–π –æ—Ç–ø—Ä–∞–≤–∫–∏ email-—É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π —Å –≥–∏–±–∫–∏–º–∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞–º–∏ SMTP –¥–ª—è –∫–∞–∂–¥–æ–π –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏–∏, –ø–æ–¥–¥–µ—Ä–∂–∫–æ–π —à–∞–±–ª–æ–Ω–æ–≤ –∏ –∑–∞—â–∏—Ç–æ–π –æ—Ç –æ—à–∏–±–æ–∫ IDNA –∫–æ–¥–∏—Ä–æ–≤–∞–Ω–∏—è.

## –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ —Å–∏—Å—Ç–µ–º—ã

### 1. EmailSettings - –ù–∞—Å—Ç—Ä–æ–π–∫–∏ SMTP

**–ú–æ–¥–µ–ª—å:** `deadline_control.models.EmailSettings`

–•—Ä–∞–Ω–∏—Ç –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ –ø–æ—á—Ç–æ–≤–æ–º—É —Å–µ—Ä–≤–µ—Ä—É –¥–ª—è –∫–∞–∂–¥–æ–π –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏–∏:

```python
# –ü—Ä–∏–º–µ—Ä –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è
from deadline_control.models import EmailSettings

settings = EmailSettings.get_settings(organization)
```

#### –û—Å–Ω–æ–≤–Ω—ã–µ –ø–æ–ª—è:

| –ü–æ–ª–µ | –¢–∏–ø | –û–ø–∏—Å–∞–Ω–∏–µ |
|------|-----|----------|
| `organization` | OneToOne | –°–≤—è–∑—å —Å –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏–µ–π (1 –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ –Ω–∞ 1 –æ—Ä–≥.) |
| `email_host` | CharField | SMTP —Å–µ—Ä–≤–µ—Ä (smtp.gmail.com, smtp.yandex.ru) |
| `email_port` | Integer | –ü–æ—Ä—Ç (587 –¥–ª—è TLS, 465 –¥–ª—è SSL) |
| `email_use_tls` | Boolean | –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å TLS —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ |
| `email_use_ssl` | Boolean | –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å SSL —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ |
| `email_host_user` | CharField | –õ–æ–≥–∏–Ω –Ω–∞ SMTP —Å–µ—Ä–≤–µ—Ä–µ |
| `email_host_password` | CharField | –ü–∞—Ä–æ–ª—å (–¥–ª—è Gmail - –ø–∞—Ä–æ–ª—å –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è) |
| `default_from_email` | EmailField | Email –æ—Ç–ø—Ä–∞–≤–∏—Ç–µ–ª—è (–ø–æ–ª–µ "–û—Ç –∫–æ–≥–æ") |
| `is_active` | Boolean | –í–∫–ª—é—á–∏—Ç—å/–≤—ã–∫–ª—é—á–∏—Ç—å —Ä–∞—Å—Å—ã–ª–∫—É |
| `recipient_emails` | TextField | Email –ø–æ–ª—É—á–∞—Ç–µ–ª–µ–π (–ø–æ –æ–¥–Ω–æ–º—É –Ω–∞ —Å—Ç—Ä–æ–∫—É) |

#### –ü–æ–ø—É–ª—è—Ä–Ω—ã–µ SMTP —Å–µ—Ä–≤–µ—Ä—ã:

- **Gmail**: smtp.gmail.com, –ø–æ—Ä—Ç 587, TLS
  - ‚ö†Ô∏è –¢—Ä–µ–±—É–µ—Ç—Å—è [–ø–∞—Ä–æ–ª—å –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è](https://myaccount.google.com/apppasswords)
- **–Ø–Ω–¥–µ–∫—Å**: smtp.yandex.ru, –ø–æ—Ä—Ç 465, SSL
- **Mail.ru**: smtp.mail.ru, –ø–æ—Ä—Ç 465, SSL
- **Office365**: smtp.office365.com, –ø–æ—Ä—Ç 587, TLS

### 2. EmailTemplate - –®–∞–±–ª–æ–Ω—ã –ø–∏—Å–µ–º

**–ú–æ–¥–µ–ª—å:** `deadline_control.models.EmailTemplate`

–ù–∞—Å—Ç—Ä–∞–∏–≤–∞–µ–º—ã–µ —à–∞–±–ª–æ–Ω—ã —Å HTML-—Ä–µ–¥–∞–∫—Ç–æ—Ä–æ–º –∏ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–º–∏:

```python
# –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ —à–∞–±–ª–æ–Ω–∞
subject, body = email_settings.get_email_template('instruction_journal')
formatted_body = body.format(
    organization_name=org.short_name_ru,
    date=datetime.now().strftime('%d.%m.%Y')
)
```

#### –ü–æ–ª—è —à–∞–±–ª–æ–Ω–∞:

- `template_type` - –¢–∏–ø —à–∞–±–ª–æ–Ω–∞ (–∏–∑ —Å–ø—Ä–∞–≤–æ—á–Ω–∏–∫–∞ EmailTemplateType)
- `subject` - –¢–µ–º–∞ –ø–∏—Å—å–º–∞ —Å –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–º–∏ `{variable_name}`
- `body` - HTML-—Å–æ–¥–µ—Ä–∂–∏–º–æ–µ (CKEditor5) —Å –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–º–∏
- `is_default` - –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é –¥–ª—è —ç—Ç–æ–≥–æ —Ç–∏–ø–∞
- `is_active` - –ê–∫—Ç–∏–≤–µ–Ω/–Ω–µ–∞–∫—Ç–∏–≤–µ–Ω

#### –î–æ—Å—Ç—É–ø–Ω—ã–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ:

–ó–∞–≤–∏—Å—è—Ç –æ—Ç —Ç–∏–ø–∞ —à–∞–±–ª–æ–Ω–∞. –ù–∞–ø—Ä–∏–º–µ—Ä, –¥–ª—è "–ñ—É—Ä–Ω–∞–ª –∏–Ω—Å—Ç—Ä—É–∫—Ç–∞–∂–µ–π":
- `{organization_name}` - –ù–∞–∑–≤–∞–Ω–∏–µ –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏–∏
- `{date}` - –¢–µ–∫—É—â–∞—è –¥–∞—Ç–∞
- `{document_url}` - –°—Å—ã–ª–∫–∞ –Ω–∞ –¥–æ–∫—É–º–µ–Ω—Ç
- `{subdivision_name}` - –ù–∞–∑–≤–∞–Ω–∏–µ –ø–æ–¥—Ä–∞–∑–¥–µ–ª–µ–Ω–∏—è

### 3. EmailTemplateType - –¢–∏–ø—ã —à–∞–±–ª–æ–Ω–æ–≤

**–ú–æ–¥–µ–ª—å:** `deadline_control.models.EmailTemplateType`

–°–ø—Ä–∞–≤–æ—á–Ω–∏–∫ —Ç–∏–ø–æ–≤ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π:

| –ö–æ–¥ | –ù–∞–∑–≤–∞–Ω–∏–µ | –û–ø–∏—Å–∞–Ω–∏–µ |
|-----|----------|----------|
| `instruction_journal` | –ñ—É—Ä–Ω–∞–ª –∏–Ω—Å—Ç—Ä—É–∫—Ç–∞–∂–µ–π | –†–∞—Å—Å—ã–ª–∫–∞ –æ–±—Ä–∞–∑—Ü–∞ –∂—É—Ä–Ω–∞–ª–∞ –∏–Ω—Å—Ç—Ä—É–∫—Ç–∞–∂–µ–π |
| `medical_notification` | –£–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –æ –º–µ–¥–æ—Å–º–æ—Ç—Ä–µ | –ü–ª–∞–Ω –ø—Ä–æ—Ö–æ–∂–¥–µ–Ω–∏—è –º–µ–¥–æ—Å–º–æ—Ç—Ä–æ–≤ |
| `deadline_warning` | –ü—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–µ –æ –¥–µ–¥–ª–∞–π–Ω–µ | –û–±—â–∏–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –æ —Å—Ä–æ–∫–∞—Ö |

## –ö–∞–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç —Ä–∞—Å—Å—ã–ª–∫–∞

### –ü—Ä–æ—Ü–µ—Å—Å –æ—Ç–ø—Ä–∞–≤–∫–∏ email:

```
1. –ü–æ–ª—É—á–µ–Ω–∏–µ –Ω–∞—Å—Ç—Ä–æ–µ–∫ EmailSettings –¥–ª—è –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏–∏
   ‚Üì
2. –ü—Ä–æ–≤–µ—Ä–∫–∞ –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏ (is_active = True)
   ‚Üì
3. –í–∞–ª–∏–¥–∞—Ü–∏—è SMTP –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ –∏ –ø–æ–ª—É—á–∞—Ç–µ–ª–µ–π
   ‚Üì
4. –°–æ–∑–¥–∞–Ω–∏–µ SMTP –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è (get_connection)
   ‚Üì
5. –§–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–∏—Å—å–º–∞ (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ –∏–∑ —à–∞–±–ª–æ–Ω–∞)
   ‚Üì
6. –û—Ç–ø—Ä–∞–≤–∫–∞ —á–µ—Ä–µ–∑ Django send_mail
   ‚Üì
7. –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞
```

### –ü—Ä–∏–º–µ—Ä –∫–æ–¥–∞ –æ—Ç–ø—Ä–∞–≤–∫–∏:

#### –ü—Ä–æ—Å—Ç–∞—è –æ—Ç–ø—Ä–∞–≤–∫–∞:

```python
from django.core.mail import send_mail
from deadline_control.models import EmailSettings

# –ü–æ–ª—É—á–∞–µ–º –Ω–∞—Å—Ç—Ä–æ–π–∫–∏
settings = EmailSettings.get_settings(organization)

# –ü—Ä–æ–≤–µ—Ä—è–µ–º –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å
if settings.is_active and settings.email_host:
    connection = settings.get_connection()
    recipients = settings.get_recipient_list()

    send_mail(
        subject='–¢–µ–º–∞ –ø–∏—Å—å–º–∞',
        message='–¢–µ–∫—Å—Ç –ø–∏—Å—å–º–∞',
        from_email=settings.default_from_email or settings.email_host_user,
        recipient_list=recipients,
        connection=connection,
        fail_silently=False,
    )
```

#### –ë–µ–∑–æ–ø–∞—Å–Ω–∞—è –æ—Ç–ø—Ä–∞–≤–∫–∞ —Å –≤–∞–ª–∏–¥–∞—Ü–∏–µ–π:

```python
from deadline_control.models import EmailSettings

settings = EmailSettings.get_settings(organization)

# –ú–µ—Ç–æ–¥ send_email_safe –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏:
# - –ø—Ä–æ–≤–µ—Ä—è–µ—Ç –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å –Ω–∞—Å—Ç—Ä–æ–µ–∫
# - –≤–∞–ª–∏–¥–∏—Ä—É–µ—Ç –ø–æ–ª—É—á–∞—Ç–µ–ª–µ–π –Ω–∞ IDNA –æ—à–∏–±–∫–∏
# - —Å–æ–∑–¥–∞—ë—Ç –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ
# - –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç –ø–∏—Å—å–º–æ
# - –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –¥–µ—Ç–∞–ª—å–Ω—ã–π —Å—Ç–∞—Ç—É—Å

success, error = settings.send_email_safe(
    subject='–¢–µ–º–∞ –ø–∏—Å—å–º–∞',
    message='–¢–µ–∫—Å—Ç –ø–∏—Å—å–º–∞ (plain text)',
    recipient_list=['user@example.com'],
    html_message='<p>HTML –≤–µ—Ä—Å–∏—è –ø–∏—Å—å–º–∞</p>'  # –æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ
)

if not success:
    print(f"–û—à–∏–±–∫–∞ –æ—Ç–ø—Ä–∞–≤–∫–∏: {error}")
else:
    print("–ü–∏—Å—å–º–æ —É—Å–ø–µ—à–Ω–æ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–æ!")
```

## –ó–∞—â–∏—Ç–∞ –æ—Ç –æ—à–∏–±–æ–∫ IDNA

### –ß—Ç–æ —Ç–∞–∫–æ–µ IDNA?

**IDNA (Internationalized Domain Names in Applications)** - —Å—Ç–∞–Ω–¥–∞—Ä—Ç –∫–æ–¥–∏—Ä–æ–≤–∞–Ω–∏—è –¥–æ–º–µ–Ω–Ω—ã—Ö –∏–º—ë–Ω —Å –Ω–µ-ASCII —Å–∏–º–≤–æ–ª–∞–º–∏ (–Ω–∞–ø—Ä–∏–º–µ—Ä, –∫–∏—Ä–∏–ª–ª–∏—Ü–∞).

### –¢–∏–ø–∏—á–Ω—ã–µ –æ—à–∏–±–∫–∏ IDNA:

| –û—à–∏–±–∫–∞ | –ü—Ä–∏—á–∏–Ω–∞ | –ü—Ä–∏–º–µ—Ä |
|--------|---------|--------|
| `label empty` | –î–≤–æ–π–Ω—ã–µ —Ç–æ—á–∫–∏ –ø–æ–¥—Ä—è–¥ | `smtp..gmail.com` |
| `label empty` | –¢–æ—á–∫–∞ –≤ –Ω–∞—á–∞–ª–µ/–∫–æ–Ω—Ü–µ | `smtp.gmail.com.` –∏–ª–∏ `.smtp.gmail.com` |
| `label empty` | –õ–∏—à–Ω–∏–µ –ø—Ä–æ–±–µ–ª—ã | ` smtp.gmail.com` (–ø—Ä–æ–±–µ–ª –≤ –Ω–∞—á–∞–ª–µ) |

### –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –∑–∞—â–∏—Ç–∞:

–ú–æ–¥–µ–ª—å `EmailSettings` **–∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø—Ä–æ–≤–µ—Ä—è–µ—Ç** –≤—Å–µ –ø–æ–ª—è –ø—Ä–∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–∏:

1. **–û—á–∏—Å—Ç–∫–∞ –ø—Ä–æ–±–µ–ª–æ–≤** - –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —É–¥–∞–ª—è–µ—Ç –ø—Ä–æ–±–µ–ª—ã –∏–∑ –ø–æ–ª–µ–π –ø—Ä–∏ –≤—ã–∑–æ–≤–µ `clean()`
2. **–í–∞–ª–∏–¥–∞—Ü–∏—è hostname** - –ø—Ä–æ–≤–µ—Ä—è–µ—Ç `email_host` –Ω–∞ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ—Å—Ç—å
3. **–í–∞–ª–∏–¥–∞—Ü–∏—è email** - –ø—Ä–æ–≤–µ—Ä—è–µ—Ç –≤—Å–µ email –∞–¥—Ä–µ—Å–∞ –Ω–∞ —Ñ–æ—Ä–º–∞—Ç –∏ IDNA
4. **–í–∞–ª–∏–¥–∞—Ü–∏—è –ø–æ–ª—É—á–∞—Ç–µ–ª–µ–π** - –ø—Ä–æ–≤–µ—Ä—è–µ—Ç –∫–∞–∂–¥—ã–π –∞–¥—Ä–µ—Å –≤ `recipient_emails`

#### –ú–µ—Ç–æ–¥—ã –≤–∞–ª–∏–¥–∞—Ü–∏–∏:

```python
# –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –≤—ã–∑—ã–≤–∞—é—Ç—Å—è –ø—Ä–∏ save()
settings.clean()  # –ó–∞–ø—É—Å–∫–∞–µ—Ç –≤—Å–µ –ø—Ä–æ–≤–µ—Ä–∫–∏

# –í–Ω—É—Ç—Ä–µ–Ω–Ω–∏–µ –º–µ—Ç–æ–¥—ã:
settings._validate_hostname('smtp.gmail.com', 'email_host')
settings._validate_email_field('user@example.com', 'email_host_user')
settings._validate_recipients()  # –ü—Ä–æ–≤–µ—Ä—è–µ—Ç –≤—Å–µ –ø–æ–ª—É—á–∞—Ç–µ–ª–µ–π
```

### –ü—Ä–∏–º–µ—Ä—ã –ø—Ä–æ–≤–µ—Ä–∫–∏:

```python
# –û—à–∏–±–∫–∞: –¥–≤–æ–π–Ω—ã–µ —Ç–æ—á–∫–∏ –≤ hostname
settings.email_host = 'smtp..gmail.com'
settings.clean()
# ValidationError: "–ù–µ–≤–µ—Ä–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç hostname: –Ω–∞–π–¥–µ–Ω—ã –¥–≤–æ–π–Ω—ã–µ —Ç–æ—á–∫–∏ (..)"

# –û—à–∏–±–∫–∞: —Ç–æ—á–∫–∞ –≤ –∫–æ–Ω—Ü–µ
settings.email_host = 'smtp.gmail.com.'
settings.clean()
# ValidationError: "–Ω–µ –º–æ–∂–µ—Ç –∑–∞–∫–∞–Ω—á–∏–≤–∞—Ç—å—Å—è —Ç–æ—á–∫–æ–π"

# –û—à–∏–±–∫–∞: –Ω–µ–≤–µ—Ä–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç email
settings.email_host_user = 'invalid..email@example.com'
settings.clean()
# ValidationError: "–Ω–∞–π–¥–µ–Ω—ã –¥–≤–æ–π–Ω—ã–µ —Ç–æ—á–∫–∏ (..)"
```

## Management –∫–æ–º–∞–Ω–¥—ã

### send_medical_notifications

–ö–æ–º–∞–Ω–¥–∞ –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–π —Ä–∞—Å—Å—ã–ª–∫–∏ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π –æ –º–µ–¥–æ—Å–º–æ—Ç—Ä–∞—Ö (2 —Ä–∞–∑–∞ –≤ –º–µ—Å—è—Ü).

**–ü—É—Ç—å:** `deadline_control/management/commands/send_medical_notifications.py`

#### –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ:

```bash
# –û—Ç–ø—Ä–∞–≤–∫–∞ –¥–ª—è –≤—Å–µ—Ö –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏–π
py manage.py send_medical_notifications

# –û—Ç–ø—Ä–∞–≤–∫–∞ –¥–ª—è –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–π –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏–∏
py manage.py send_medical_notifications --organization 1

# –û—Ç–ø—Ä–∞–≤–∫–∞ –Ω–∞ –∫–∞—Å—Ç–æ–º–Ω—ã–µ email (–∏–≥–Ω–æ—Ä–∏—Ä—É–µ—Ç –Ω–∞—Å—Ç—Ä–æ–π–∫–∏)
py manage.py send_medical_notifications --emails "user1@example.com,user2@example.com"
```

#### –õ–æ–≥–∏–∫–∞ –∫–æ–º–∞–Ω–¥—ã:

1. –ü–æ–ª—É—á–∞–µ—Ç —Å–ø–∏—Å–æ–∫ –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏–π –¥–ª—è –æ–±—Ä–∞–±–æ—Ç–∫–∏
2. –î–ª—è –∫–∞–∂–¥–æ–π –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏–∏:
   - –ü—Ä–æ–≤–µ—Ä—è–µ—Ç –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ EmailSettings
   - –°–æ–±–∏—Ä–∞–µ—Ç –ø–æ–ª—É—á–∞—Ç–µ–ª–µ–π –∏–∑ —Å–∏—Å—Ç–µ–º—ã email_recipients
   - –§–æ—Ä–º–∏—Ä—É–µ—Ç –æ—Ç—á—ë—Ç –æ –º–µ–¥–æ—Å–º–æ—Ç—Ä–∞—Ö (–ø—Ä–æ—Å—Ä–æ—á–µ–Ω–Ω—ã–µ, –ø—Ä–µ–¥—Å—Ç–æ—è—â–∏–µ, –±–µ–∑ –¥–∞—Ç—ã)
   - –û—Ç–ø—Ä–∞–≤–ª—è–µ—Ç –ø–∏—Å—å–º–æ —á–µ—Ä–µ–∑ –Ω–∞—Å—Ç—Ä–æ–µ–Ω–Ω—ã–π SMTP
3. –í—ã–≤–æ–¥–∏—Ç —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É (–æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–æ/–æ—à–∏–±–æ–∫)

#### –ü—Ä–∏–º–µ—Ä—ã –≤—ã–≤–æ–¥–∞:

```
--- –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏–∏: –û–û–û "–ü—Ä–∏–º–µ—Ä" ---
‚úÖ –£–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–æ –¥–ª—è –û–û–û "–ü—Ä–∏–º–µ—Ä"!
   –ü–æ–ª—É—á–∞—Ç–µ–ª–∏: admin@example.com, hr@example.com
   –ë–µ–∑ –¥–∞—Ç—ã: 3, –ü—Ä–æ—Å—Ä–æ—á–µ–Ω–Ω—ã–µ: 5, –ü—Ä–µ–¥—Å—Ç–æ—è—â–∏–µ: 12

‚ùå –û—à–∏–±–∫–∞ –ø—Ä–∏ –æ—Ç–ø—Ä–∞–≤–∫–µ email –¥–ª—è –û–û–û "–¢–µ—Å—Ç": –°–ø–∏—Å–æ–∫ –ø–æ–ª—É—á–∞—Ç–µ–ª–µ–π –ø—É—Å—Ç–æ–π
```

## –ö–Ω–æ–ø–∫–∏ —Ä—É—á–Ω–æ–≥–æ –∑–∞–ø—É—Å–∫–∞ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π

### –û—Ç–ø—Ä–∞–≤–∫–∞ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π –∏–∑ –∞–¥–º–∏–Ω-–ø–∞–Ω–µ–ª–∏

–ü–æ–º–∏–º–æ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏—Ö –∫–æ–º–∞–Ω–¥, —Å–∏—Å—Ç–µ–º–∞ –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç –∫–Ω–æ–ø–∫–∏ –¥–ª—è —Ä—É—á–Ω–æ–≥–æ –∑–∞–ø—É—Å–∫–∞ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π –ø—Ä—è–º–æ –∏–∑ –∞–¥–º–∏–Ω–∫–∏.

#### 1. –ú–µ–¥–∏—Ü–∏–Ω—Å–∫–∏–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è

**–ú–µ—Å—Ç–æ–ø–æ–ª–æ–∂–µ–Ω–∏–µ:** `/admin/deadline_control/medicalsettings/`

**–ö–Ω–æ–ø–∫–∞:** "üìß –û—Ç–ø—Ä–∞–≤–∏—Ç—å —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ" –≤ –∫–æ–ª–æ–Ω–∫–µ "–î–µ–π—Å—Ç–≤–∏—è"

**–ß—Ç–æ –¥–µ–ª–∞–µ—Ç:**
- –°–æ–±–∏—Ä–∞–µ—Ç –≤—Å–µ—Ö —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤ –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏–∏ —Å –º–µ–¥–æ—Å–º–æ—Ç—Ä–∞–º–∏
- –†–∞–∑–¥–µ–ª—è–µ—Ç –ø–æ –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º: –±–µ–∑ –¥–∞—Ç—ã, –ø—Ä–æ—Å—Ä–æ—á–µ–Ω–Ω—ã–µ, –ø—Ä–µ–¥—Å—Ç–æ—è—â–∏–µ
- –§–æ—Ä–º–∏—Ä—É–µ—Ç –¥–µ—Ç–∞–ª—å–Ω—ã–π –æ—Ç—á–µ—Ç
- –û—Ç–ø—Ä–∞–≤–ª—è–µ—Ç –Ω–∞ –ø–æ–ª—É—á–∞—Ç–µ–ª–µ–π –∏–∑ EmailSettings
- –°–æ–∑–¥–∞–µ—Ç –∑–∞–ø–∏—Å—å –≤ `MedicalNotificationSendLog` —Å —Ç–∏–ø–æ–º `manual`

**–ü—Ä–∏–º–µ—Ä –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è:**

1. –û—Ç–∫—Ä—ã—Ç—å –∞–¥–º–∏–Ω–∫—É ‚Üí –ö–æ–Ω—Ç—Ä–æ–ª—å —Å—Ä–æ–∫–æ–≤ ‚Üí –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –º–µ–¥–æ—Å–º–æ—Ç—Ä–æ–≤
2. –ù–∞–π—Ç–∏ –Ω—É–∂–Ω—É—é –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏—é –≤ —Å–ø–∏—Å–∫–µ
3. –ù–∞–∂–∞—Ç—å –∫–Ω–æ–ø–∫—É "üìß –û—Ç–ø—Ä–∞–≤–∏—Ç—å —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ"
4. –ü–æ–ª—É—á–∏—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç:

```
‚úÖ –£–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –æ –º–µ–¥–æ—Å–º–æ—Ç—Ä–∞—Ö –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–æ!
–ü–æ–ª—É—á–∞—Ç–µ–ª–∏: hr@example.com, director@example.com
–ë–µ–∑ –¥–∞—Ç—ã: 3, –ü—Ä–æ—Å—Ä–æ—á–µ–Ω–Ω—ã–µ: 5, –ü—Ä–µ–¥—Å—Ç–æ—è—â–∏–µ: 12
```

**–§–∞–π–ª:** `deadline_control/admin/medical_examination.py:172-447`

**–ú–µ—Ç–æ–¥:** `MedicalSettingsAdmin.send_medical_notification()`

#### 2. –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –æ –∫–ª—é—á–µ–≤—ã—Ö –º–µ—Ä–æ–ø—Ä–∏—è—Ç–∏—è—Ö

**–ú–µ—Å—Ç–æ–ø–æ–ª–æ–∂–µ–Ω–∏–µ:** `/admin/deadline_control/keydeadlinecategory/`

**–ö–Ω–æ–ø–∫–∞:** "üìß –û—Ç–ø—Ä–∞–≤–∏—Ç—å —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ" –≤ –∫–æ–ª–æ–Ω–∫–µ "–î–µ–π—Å—Ç–≤–∏—è"

**–ß—Ç–æ –¥–µ–ª–∞–µ—Ç:**
- –°–æ–±–∏—Ä–∞–µ—Ç –≤—Å–µ –º–µ—Ä–æ–ø—Ä–∏—è—Ç–∏—è –≤ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏
- –§–∏–ª—å—Ç—Ä—É–µ—Ç –ø—Ä–æ—Å—Ä–æ—á–µ–Ω–Ω—ã–µ –∏ –ø—Ä–µ–¥—Å—Ç–æ—è—â–∏–µ (–≤ —Ç–µ—á–µ–Ω–∏–µ 30 –¥–Ω–µ–π)
- –§–æ—Ä–º–∏—Ä—É–µ—Ç –æ—Ç—á–µ—Ç –ø–æ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏
- –û—Ç–ø—Ä–∞–≤–ª—è–µ—Ç –Ω–∞ –ø–æ–ª—É—á–∞—Ç–µ–ª–µ–π –∏–∑ EmailSettings
- –°–æ–∑–¥–∞–µ—Ç –∑–∞–ø–∏—Å—å –≤ `KeyDeadlineSendLog` —Å —Ç–∏–ø–æ–º `manual`

**–û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏:**
- –ö–Ω–æ–ø–∫–∞ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ –¥–ª—è **–∞–∫—Ç–∏–≤–Ω—ã—Ö** –∫–∞—Ç–µ–≥–æ—Ä–∏–π
- –ï—Å–ª–∏ –Ω–µ—Ç –ø—Ä–æ—Å—Ä–æ—á–µ–Ω–Ω—ã—Ö/–ø—Ä–µ–¥—Å—Ç–æ—è—â–∏—Ö –º–µ—Ä–æ–ø—Ä–∏—è—Ç–∏–π - –æ—Ç–ø—Ä–∞–≤–∫–∞ –Ω–µ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç—Å—è

**–ü—Ä–∏–º–µ—Ä –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è:**

1. –û—Ç–∫—Ä—ã—Ç—å –∞–¥–º–∏–Ω–∫—É ‚Üí –ö–æ–Ω—Ç—Ä–æ–ª—å —Å—Ä–æ–∫–æ–≤ ‚Üí –ö–∞—Ç–µ–≥–æ—Ä–∏–∏ –∫–ª—é—á–µ–≤—ã—Ö —Å—Ä–æ–∫–æ–≤
2. –ù–∞–π—Ç–∏ –∫–∞—Ç–µ–≥–æ—Ä–∏—é "–¢–µ—Ö–Ω–∏—á–µ—Å–∫–æ–µ –æ–±—Å–ª—É–∂–∏–≤–∞–Ω–∏–µ"
3. –ù–∞–∂–∞—Ç—å –∫–Ω–æ–ø–∫—É "üìß –û—Ç–ø—Ä–∞–≤–∏—Ç—å —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ"
4. –ü–æ–ª—É—á–∏—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç:

```
‚úÖ –£–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –æ –∫–ª—é—á–µ–≤—ã—Ö –º–µ—Ä–æ–ø—Ä–∏—è—Ç–∏—è—Ö –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–æ!
–ö–∞—Ç–µ–≥–æ—Ä–∏—è: –¢–µ—Ö–Ω–∏—á–µ—Å–∫–æ–µ –æ–±—Å–ª—É–∂–∏–≤–∞–Ω–∏–µ
–ü–æ–ª—É—á–∞—Ç–µ–ª–∏: engineer@example.com, safety@example.com
–ü—Ä–æ—Å—Ä–æ—á–µ–Ω–Ω—ã–µ: 2, –ü—Ä–µ–¥—Å—Ç–æ—è—â–∏–µ: 8
```

**–§–∞–π–ª:** `deadline_control/admin/key_deadline.py:110-368`

**–ú–µ—Ç–æ–¥:** `KeyDeadlineCategoryAdmin.send_key_deadline_notification()`

### –ü—Ä–æ–≤–µ—Ä–∫–∏ –ø–µ—Ä–µ–¥ –æ—Ç–ø—Ä–∞–≤–∫–æ–π

–ü–µ—Ä–µ–¥ –æ—Ç–ø—Ä–∞–≤–∫–æ–π —Å–∏—Å—Ç–µ–º–∞ –ø—Ä–æ–≤–µ—Ä—è–µ—Ç:

1. ‚úÖ **–ê–∫—Ç–∏–≤–Ω–æ—Å—Ç—å EmailSettings** - `is_active = True`
2. ‚úÖ **–ù–∞–ª–∏—á–∏–µ SMTP –Ω–∞—Å—Ç—Ä–æ–µ–∫** - –∑–∞–ø–æ–ª–Ω–µ–Ω–æ `email_host`
3. ‚úÖ **–ù–∞–ª–∏—á–∏–µ –ø–æ–ª—É—á–∞—Ç–µ–ª–µ–π** - –µ—Å—Ç—å email –≤ `recipient_emails`
4. ‚úÖ **–ù–∞–ª–∏—á–∏–µ –¥–∞–Ω–Ω—ã—Ö** - –µ—Å—Ç—å —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∏/–º–µ—Ä–æ–ø—Ä–∏—è—Ç–∏—è –¥–ª—è –æ—Ç–ø—Ä–∞–≤–∫–∏

–ï—Å–ª–∏ –ª—é–±–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ –Ω–µ –ø—Ä–æ–π–¥–µ–Ω–∞ - –æ—Ç–ø—Ä–∞–≤–∫–∞ –æ—Ç–º–µ–Ω—è–µ—Ç—Å—è —Å –∏–Ω—Ñ–æ—Ä–º–∞—Ç–∏–≤–Ω—ã–º —Å–æ–æ–±—â–µ–Ω–∏–µ–º.

### –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ —Ä—É—á–Ω—ã—Ö –æ—Ç–ø—Ä–∞–≤–æ–∫

–í—Å–µ —Ä—É—á–Ω—ã–µ –æ—Ç–ø—Ä–∞–≤–∫–∏ –ª–æ–≥–∏—Ä—É—é—Ç—Å—è —Å —Ç–∏–ø–æ–º `notification_type='manual'`:

**–ú–µ–¥–∏—Ü–∏–Ω—Å–∫–∏–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è:**
```python
MedicalNotificationSendLog.objects.create(
    organization=organization,
    initiated_by=request.user,  # –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å, –Ω–∞–∂–∞–≤—à–∏–π –∫–Ω–æ–ø–∫—É
    notification_type='manual',
    ...
)
```

**–ö–ª—é—á–µ–≤—ã–µ –º–µ—Ä–æ–ø—Ä–∏—è—Ç–∏—è:**
```python
KeyDeadlineSendLog.objects.create(
    organization=organization,
    initiated_by=request.user,
    notification_type='manual',
    ...
)
```

### –ü—Ä–æ—Å–º–æ—Ç—Ä –∏—Å—Ç–æ—Ä–∏–∏ –æ—Ç–ø—Ä–∞–≤–æ–∫

–ò—Å—Ç–æ—Ä–∏—è –¥–æ—Å—Ç—É–ø–Ω–∞ –≤ –∞–¥–º–∏–Ω–∫–µ:

- **–ú–µ–¥–∏—Ü–∏–Ω—Å–∫–∏–µ:** `/admin/deadline_control/medicalnotificationsendlog/`
- **–ö–ª—é—á–µ–≤—ã–µ –º–µ—Ä–æ–ø—Ä–∏—è—Ç–∏—è:** `/admin/deadline_control/keydeadlinesendlog/`

–î–µ—Ç–∞–ª–∏ –∫–∞–∂–¥–æ–π –æ—Ç–ø—Ä–∞–≤–∫–∏:
- –î–∞—Ç–∞ –∏ –≤—Ä–µ–º—è
- –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å (–∫—Ç–æ –Ω–∞–∂–∞–ª –∫–Ω–æ–ø–∫—É)
- –°–ø–∏—Å–æ–∫ –ø–æ–ª—É—á–∞—Ç–µ–ª–µ–π
- –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ (–∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤/–º–µ—Ä–æ–ø—Ä–∏—è—Ç–∏–π)
- –°—Ç–∞—Ç—É—Å (—É—Å–ø–µ—à–Ω–æ/–æ—à–∏–±–∫–∞)
- –¢–µ–∫—Å—Ç –æ—à–∏–±–∫–∏ (–µ—Å–ª–∏ –±—ã–ª–∞)

### –°—Ä–∞–≤–Ω–µ–Ω–∏–µ: –∫–æ–º–∞–Ω–¥—ã vs –∫–Ω–æ–ø–∫–∏

| –ü–∞—Ä–∞–º–µ—Ç—Ä | Management –∫–æ–º–∞–Ω–¥—ã | –ö–Ω–æ–ø–∫–∏ –≤ –∞–¥–º–∏–Ω–∫–µ |
|----------|-------------------|------------------|
| **–ó–∞–ø—É—Å–∫** | –í—Ä—É—á–Ω—É—é —á–µ—Ä–µ–∑ —Ç–µ—Ä–º–∏–Ω–∞–ª –∏–ª–∏ –ø–æ —Ä–∞—Å–ø–∏—Å–∞–Ω–∏—é (cron) | –í—Ä—É—á–Ω—É—é —á–µ—Ä–µ–∑ –≤–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å |
| **–¢–∏–ø –ª–æ–≥–∞** | `notification_type='scheduled'` | `notification_type='manual'` |
| **–ò–Ω–∏—Ü–∏–∞—Ç–æ—Ä** | `initiated_by=None` | `initiated_by=request.user` |
| **–ü–æ–ª—É—á–∞—Ç–µ–ª–∏** | –ú–æ–∂–Ω–æ –ø–µ—Ä–µ–æ–ø—Ä–µ–¥–µ–ª–∏—Ç—å —á–µ—Ä–µ–∑ `--emails` | –¢–æ–ª—å–∫–æ –∏–∑ EmailSettings |
| **–û—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏—è** | –ú–æ–∂–Ω–æ –≤—ã–±—Ä–∞—Ç—å —á–µ—Ä–µ–∑ `--organization` | –¢–æ–ª—å–∫–æ —Ç–µ–∫—É—â–∞—è (–∏–∑ –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞) |
| **–£–¥–æ–±—Å—Ç–≤–æ** | –î–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏–∏ | –î–ª—è –±—ã—Å—Ç—Ä–æ–π —Ä—É—á–Ω–æ–π –æ—Ç–ø—Ä–∞–≤–∫–∏ |

## –°–∏—Å—Ç–µ–º–∞ –ø–æ–ª—É—á–∞—Ç–µ–ª–µ–π (Email Recipients)

–¢—Ä—ë—Ö—É—Ä–æ–≤–Ω–µ–≤–∞—è —Å–∏—Å—Ç–µ–º–∞ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è –ø–æ–ª—É—á–∞—Ç–µ–ª–µ–π –ø–∏—Å–µ–º:

### –£—Ä–æ–≤–Ω–∏ –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç–∞:

1. **SubdivisionEmail** - Email –¥–ª—è –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ –ø–æ–¥—Ä–∞–∑–¥–µ–ª–µ–Ω–∏—è
2. **–û—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω—ã–µ —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∏** - –°–æ—Ç—Ä—É–¥–Ω–∏–∫–∏ —Å —Ç–∏–ø–æ–º –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç–∏ "Email-—É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è"
3. **EmailSettings.recipient_emails** - –ì–ª–æ–±–∞–ª—å–Ω—ã–π —Å–ø–∏—Å–æ–∫ –¥–ª—è –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏–∏

**–§—É–Ω–∫—Ü–∏—è:** `directory.utils.email_recipients.collect_recipients_for_subdivision()`

```python
from directory.utils.email_recipients import collect_recipients_for_subdivision

# –°–±–æ—Ä –ø–æ–ª—É—á–∞—Ç–µ–ª–µ–π –¥–ª—è –ø–æ–¥—Ä–∞–∑–¥–µ–ª–µ–Ω–∏—è
recipients = collect_recipients_for_subdivision(
    subdivision=subdivision_obj,
    organization=organization_obj
)
# –†–µ–∑—É–ª—å—Ç–∞—Ç: ['email1@example.com', 'email2@example.com']

# –°–±–æ—Ä —Ç–æ–ª—å–∫–æ –≥–ª–æ–±–∞–ª—å–Ω—ã—Ö –ø–æ–ª—É—á–∞—Ç–µ–ª–µ–π (–±–µ–∑ –ø–æ–¥—Ä–∞–∑–¥–µ–ª–µ–Ω–∏—è)
recipients = collect_recipients_for_subdivision(
    subdivision=None,
    organization=organization_obj
)
```

## –ê–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å

### –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞–º–∏ SMTP

**URL:** `/admin/deadline_control/emailsettings/`

#### –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏:

- ‚úÖ –°–æ–∑–¥–∞–Ω–∏–µ/—Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –Ω–∞—Å—Ç—Ä–æ–µ–∫ –¥–ª—è –∫–∞–∂–¥–æ–π –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏–∏
- ‚úÖ –¢–µ—Å—Ç–æ–≤–∞—è –æ—Ç–ø—Ä–∞–≤–∫–∞ email (–∫–Ω–æ–ø–∫–∞ "–¢–µ—Å—Ç email")
- ‚úÖ –í–∏–∑—É–∞–ª—å–Ω—ã–µ –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä—ã —Å—Ç–∞—Ç—É—Å–∞ (–∞–∫—Ç–∏–≤–Ω–æ/–æ—Ç–∫–ª—é—á–µ–Ω–æ)
- ‚úÖ –°—á—ë—Ç—á–∏–∫ –ø–æ–ª—É—á–∞—Ç–µ–ª–µ–π
- ‚úÖ –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è –ø–æ –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏—è–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
- ‚úÖ –ü–æ–¥—Å–∫–∞–∑–∫–∏ –¥–ª—è –ø–æ–ø—É–ª—è—Ä–Ω—ã—Ö SMTP —Å–µ—Ä–≤–µ—Ä–æ–≤

#### –ö–Ω–æ–ø–∫–∞ "–¢–µ—Å—Ç email":

–ü—Ä–∏ –Ω–∞–∂–∞—Ç–∏–∏ –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç —Ç–µ—Å—Ç–æ–≤–æ–µ –ø–∏—Å—å–º–æ:
- –ï—Å–ª–∏ —É–∫–∞–∑–∞–Ω—ã –ø–æ–ª—É—á–∞—Ç–µ–ª–∏ ‚Üí –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç –∏–º
- –ï—Å–ª–∏ –Ω–µ —É–∫–∞–∑–∞–Ω—ã ‚Üí –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç –Ω–∞ email –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞
- –ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç –¥–µ—Ç–∞–ª—å–Ω—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è –æ–± —É—Å–ø–µ—Ö–µ/–æ—à–∏–±–∫–∞—Ö

### –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —à–∞–±–ª–æ–Ω–∞–º–∏

**URL:** `/admin/deadline_control/emailtemplate/`

#### –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏:

- ‚úÖ –°–æ–∑–¥–∞–Ω–∏–µ —à–∞–±–ª–æ–Ω–æ–≤ —Å HTML-—Ä–µ–¥–∞–∫—Ç–æ—Ä–æ–º (CKEditor5)
- ‚úÖ –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –≤ —Ñ–∏–≥—É—Ä–Ω—ã—Ö —Å–∫–æ–±–∫–∞—Ö `{variable}`
- ‚úÖ –û–¥–∏–Ω —à–∞–±–ª–æ–Ω –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é –Ω–∞ —Ç–∏–ø –∏ –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏—é
- ‚úÖ –ü—Ä–µ–¥–ø—Ä–æ—Å–º–æ—Ç—Ä –¥–æ—Å—Ç—É–ø–Ω—ã—Ö –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö

## –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å –¥—Ä—É–≥–∏–º–∏ –º–æ–¥—É–ª—è–º–∏

### 1. –ñ—É—Ä–Ω–∞–ª –∏–Ω—Å—Ç—Ä—É–∫—Ç–∞–∂–µ–π

–ü—Ä–∏ –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –∂—É—Ä–Ω–∞–ª–∞ –∏–Ω—Å—Ç—Ä—É–∫—Ç–∞–∂–µ–π:

```python
from directory.views.documents.instruction_journal import InstructionJournalView

# –ü–æ—Å–ª–µ —Å–æ–∑–¥–∞–Ω–∏—è –¥–æ–∫—É–º–µ–Ω—Ç–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç—Å—è email
# —Å —Å—Å—ã–ª–∫–æ–π –Ω–∞ —Å–∫–∞—á–∏–≤–∞–Ω–∏–µ —á–µ—Ä–µ–∑ —à–∞–±–ª–æ–Ω 'instruction_journal'
```

### 2. –ú–µ–¥–∏—Ü–∏–Ω—Å–∫–∏–µ –æ—Å–º–æ—Ç—Ä—ã

–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è —Ä–∞—Å—Å—ã–ª–∫–∞ —á–µ—Ä–µ–∑ –∫–æ–º–∞–Ω–¥—É `send_medical_notifications`:

- –†–∞—Å–ø–∏—Å–∞–Ω–∏–µ: 2 —Ä–∞–∑–∞ –≤ –º–µ—Å—è—Ü (–Ω–∞—Å—Ç—Ä–∞–∏–≤–∞–µ—Ç—Å—è –≤ cron/task scheduler)
- –§–æ—Ä–º–∞—Ç: –¢–µ–∫—Å—Ç–æ–≤—ã–π –æ—Ç—á—ë—Ç —Å –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º–∏ (–±–µ–∑ –¥–∞—Ç—ã, –ø—Ä–æ—Å—Ä–æ—á–µ–Ω–Ω—ã–µ, –ø—Ä–µ–¥—Å—Ç–æ—è—â–∏–µ)

### 3. –î–µ–¥–ª–∞–π–Ω—ã –æ–±–æ—Ä—É–¥–æ–≤–∞–Ω–∏—è

_(–ø–ª–∞–Ω–∏—Ä—É–µ—Ç—Å—è)_ –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –æ –ø—Ä–µ–¥—Å—Ç–æ—è—â–∏—Ö –ø—Ä–æ–≤–µ—Ä–∫–∞—Ö –æ–±–æ—Ä—É–¥–æ–≤–∞–Ω–∏—è

## –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å

### –•—Ä–∞–Ω–µ–Ω–∏–µ –ø–∞—Ä–æ–ª–µ–π

‚ö†Ô∏è **–í–Ω–∏–º–∞–Ω–∏–µ:** –ü–∞—Ä–æ–ª–∏ SMTP —Ö—Ä–∞–Ω—è—Ç—Å—è –≤ –ë–î –≤ **–æ—Ç–∫—Ä—ã—Ç–æ–º –≤–∏–¥–µ**.

**–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏:**
1. –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ **–ø–∞—Ä–æ–ª–∏ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–π** (–¥–ª—è Gmail, –Ø–Ω–¥–µ–∫—Å)
2. –°–æ–∑–¥–∞–π—Ç–µ –æ—Ç–¥–µ–ª—å–Ω—ã–π email-–∞–∫–∫–∞—É–Ω—Ç –¥–ª—è —Ä–∞—Å—Å—ã–ª–∫–∏
3. –û–≥—Ä–∞–Ω–∏—á—å—Ç–µ –¥–æ—Å—Ç—É–ø –∫ –∞–¥–º–∏–Ω-–ø–∞–Ω–µ–ª–∏

### Gmail - –ø–∞—Ä–æ–ª–∏ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–π

1. –í–∫–ª—é—á–∏—Ç–µ –¥–≤—É—Ö—Ñ–∞–∫—Ç–æ—Ä–Ω—É—é –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—é
2. –ü–µ—Ä–µ–π–¥–∏—Ç–µ: https://myaccount.google.com/apppasswords
3. –°–æ–∑–¥–∞–π—Ç–µ –ø–∞—Ä–æ–ª—å –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è –¥–ª—è "–ü–æ—á—Ç–∞"
4. –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ 16-—Å–∏–º–≤–æ–ª—å–Ω—ã–π –ø–∞—Ä–æ–ª—å –≤ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞—Ö

### –ó–∞—â–∏—Ç–∞ –æ—Ç —Å–ø–∞–º–∞

- –°–∏—Å—Ç–µ–º–∞ –ù–ï –ø–æ–∑–≤–æ–ª—è–µ—Ç –º–∞—Å—Å–æ–≤—É—é —Ä–∞—Å—Å—ã–ª–∫—É –Ω–µ–∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–º
- –ü–æ–ª—É—á–∞—Ç–µ–ª–∏ –æ–ø—Ä–µ–¥–µ–ª—è—é—Ç—Å—è —Å—Ç—Ä–æ–≥–æ —á–µ—Ä–µ–∑ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏–∏
- –ù–µ—Ç –ø—É–±–ª–∏—á–Ω—ã—Ö —Ñ–æ—Ä–º –ø–æ–¥–ø–∏—Å–∫–∏

## –£—Å—Ç—Ä–∞–Ω–µ–Ω–∏–µ –Ω–µ–ø–æ–ª–∞–¥–æ–∫

### –û—à–∏–±–∫–∞: "IDNA codec can't encode character"

**–ü—Ä–∏—á–∏–Ω–∞:** –ù–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç hostname –∏–ª–∏ email (–¥–≤–æ–π–Ω—ã–µ —Ç–æ—á–∫–∏, –ø—Ä–æ–±–µ–ª—ã)

**–†–µ—à–µ–Ω–∏–µ:**
1. –û—Ç–∫—Ä–æ–π—Ç–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ EmailSettings –≤ –∞–¥–º–∏–Ω–∫–µ
2. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø–æ–ª—è –Ω–∞ –ª–∏—à–Ω–∏–µ —Å–∏–º–≤–æ–ª—ã
3. –ü–µ—Ä–µ—Å–æ—Ö—Ä–∞–Ω–∏—Ç–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ (–≤–∞–ª–∏–¥–∞—Ü–∏—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∏—Å–ø—Ä–∞–≤–∏—Ç)

**–î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞:**

```bash
# –ó–∞–ø—É—Å—Ç–∏—Ç–µ —Å–∫—Ä–∏–ø—Ç –ø—Ä–æ–≤–µ—Ä–∫–∏
py check_email_settings.py

# –í—ã–≤–æ–¥ –ø–æ–∫–∞–∂–µ—Ç –ø—Ä–æ–±–ª–µ–º–Ω—ã–µ –ø–æ–ª—è
```

### –û—à–∏–±–∫–∞: "SMTPAuthenticationError"

**–ü—Ä–∏—á–∏–Ω–∞:** –ù–µ–≤–µ—Ä–Ω—ã–π –ª–æ–≥–∏–Ω/–ø–∞—Ä–æ–ª—å

**–†–µ—à–µ–Ω–∏–µ (Gmail):**
1. –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –ø–∞—Ä–æ–ª—å –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è (–Ω–µ –ø–∞—Ä–æ–ª—å –∞–∫–∫–∞—É–Ω—Ç–∞!)
2. –í–∫–ª—é—á–∏—Ç–µ "–î–æ—Å—Ç—É–ø –Ω–µ–±–µ–∑–æ–ø–∞—Å–Ω—ã—Ö –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–π" (–Ω–µ —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)
3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ 2FA

**–†–µ—à–µ–Ω–∏–µ (–Ø–Ω–¥–µ–∫—Å/Mail.ru):**
1. –°–æ–∑–¥–∞–π—Ç–µ –ø–∞—Ä–æ–ª—å –¥–ª—è –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–π –≤ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞—Ö –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏
2. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ SMTP –¥–æ—Å—Ç—É–ø —Ä–∞–∑—Ä–µ—à—ë–Ω

### –û—à–∏–±–∫–∞: "Connection refused" –∏–ª–∏ "Timeout"

**–ü—Ä–∏—á–∏–Ω–∞:** –ù–µ–≤–µ—Ä–Ω—ã–π –ø–æ—Ä—Ç –∏–ª–∏ TLS/SSL –Ω–∞—Å—Ç—Ä–æ–π–∫–∏

**–†–µ—à–µ–Ω–∏–µ:**
1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø–æ—Ä—Ç: 587 (TLS) –∏–ª–∏ 465 (SSL)
2. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ TLS –∏ SSL –Ω–µ –≤–∫–ª—é—á–µ–Ω—ã –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ
3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ firewall

### –ü–∏—Å—å–º–∞ –Ω–µ –ø—Ä–∏—Ö–æ–¥—è—Ç

**–ü—Ä–æ–≤–µ—Ä—å—Ç–µ:**

1. **–ê–∫—Ç–∏–≤–Ω–æ—Å—Ç—å:** `is_active = True`
2. **–ü–æ–ª—É—á–∞—Ç–µ–ª–∏:** –ó–∞–ø–æ–ª–Ω–µ–Ω–æ –ø–æ–ª–µ `recipient_emails`
3. **–°–ø–∞–º:** –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø–∞–ø–∫—É "–°–ø–∞–º" —É –ø–æ–ª—É—á–∞—Ç–µ–ª–µ–π
4. **–¢–µ—Å—Ç–æ–≤–∞—è –æ—Ç–ø—Ä–∞–≤–∫–∞:** –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –∫–Ω–æ–ø–∫—É "–¢–µ—Å—Ç email" –≤ –∞–¥–º–∏–Ω–∫–µ

**–î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞:**

```bash
# –ó–∞–ø—É—Å—Ç–∏—Ç–µ –∫–æ–º–∞–Ω–¥—É —Å —Ñ–ª–∞–≥–æ–º --emails –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è
py manage.py send_medical_notifications --emails "your@email.com" --organization 1
```

## –†–∞—Å—à–∏—Ä–µ–Ω–∏–µ —Å–∏—Å—Ç–µ–º—ã

### –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –Ω–æ–≤–æ–≥–æ —Ç–∏–ø–∞ —à–∞–±–ª–æ–Ω–∞

1. –°–æ–∑–¥–∞–π—Ç–µ `EmailTemplateType` –≤ –∞–¥–º–∏–Ω–∫–µ:

```python
EmailTemplateType.objects.create(
    name='–ù–æ–≤—ã–π —Ç–∏–ø —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è',
    code='new_notification_type',
    description='–û–ø–∏—Å–∞–Ω–∏–µ –Ω–∞–∑–Ω–∞—á–µ–Ω–∏—è',
    available_variables={
        'variable1': '–û–ø–∏—Å–∞–Ω–∏–µ –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π 1',
        'variable2': '–û–ø–∏—Å–∞–Ω–∏–µ –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π 2'
    }
)
```

2. –°–æ–∑–¥–∞–π—Ç–µ —à–∞–±–ª–æ–Ω –¥–ª—è –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏–∏ –≤ –∞–¥–º–∏–Ω–∫–µ

3. –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –≤ –∫–æ–¥–µ:

```python
subject, body = email_settings.get_email_template('new_notification_type')
formatted = body.format(
    variable1='–∑–Ω–∞—á–µ–Ω–∏–µ1',
    variable2='–∑–Ω–∞—á–µ–Ω–∏–µ2'
)
```

### –°–æ–∑–¥–∞–Ω–∏–µ –Ω–æ–≤–æ–π –∫–æ–º–∞–Ω–¥—ã —Ä–∞—Å—Å—ã–ª–∫–∏

```python
# –ü—Ä–∏–º–µ—Ä: deadline_control/management/commands/send_deadline_warnings.py

from django.core.management.base import BaseCommand
from deadline_control.models import EmailSettings

class Command(BaseCommand):
    help = '–û—Ç–ø—Ä–∞–≤–∫–∞ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π –æ –¥–µ–¥–ª–∞–π–Ω–∞—Ö'

    def handle(self, *args, **options):
        for organization in Organization.objects.all():
            settings = EmailSettings.get_settings(organization)

            # –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –±–µ–∑–æ–ø–∞—Å–Ω—É—é –æ—Ç–ø—Ä–∞–≤–∫—É
            success, error = settings.send_email_safe(
                subject='–£–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –æ –¥–µ–¥–ª–∞–π–Ω–∞—Ö',
                message='–¢–µ–∫—Å—Ç —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è...',
                recipient_list=settings.get_recipient_list()
            )

            if not success:
                self.stdout.write(
                    self.style.ERROR(f'–û—à–∏–±–∫–∞: {error}')
                )
            else:
                self.stdout.write(
                    self.style.SUCCESS('–û—Ç–ø—Ä–∞–≤–ª–µ–Ω–æ!')
                )
```

## –ü—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è

### –û—Ç–ø—Ä–∞–≤–∫–∞ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –ø—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ –¥–æ–∫—É–º–µ–Ω—Ç–∞

```python
from deadline_control.models import EmailSettings

def send_document_notification(organization, document):
    settings = EmailSettings.get_settings(organization)

    # –ü–æ–ª—É—á–∞–µ–º —à–∞–±–ª–æ–Ω
    subject, body = settings.get_email_template('instruction_journal')

    # –ü–æ–¥—Å—Ç–∞–≤–ª—è–µ–º –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ
    context = {
        'organization_name': organization.short_name_ru,
        'document_url': document.get_absolute_url(),
        'date': datetime.now().strftime('%d.%m.%Y')
    }

    formatted_subject = subject.format(**context)
    formatted_body = body.format(**context)

    # –ë–µ–∑–æ–ø–∞—Å–Ω–∞—è –æ—Ç–ø—Ä–∞–≤–∫–∞
    success, error = settings.send_email_safe(
        subject=formatted_subject,
        message='',  # plain text –≤–µ—Ä—Å–∏—è
        recipient_list=settings.get_recipient_list(),
        html_message=formatted_body
    )

    return success, error
```

### –û—Ç–ø—Ä–∞–≤–∫–∞ –Ω–∞ –∫–∞—Å—Ç–æ–º–Ω—ã–π —Å–ø–∏—Å–æ–∫ –ø–æ–ª—É—á–∞—Ç–µ–ª–µ–π

```python
settings = EmailSettings.get_settings(organization)

custom_recipients = [
    'manager1@example.com',
    'manager2@example.com'
]

success, error = settings.send_email_safe(
    subject='–°–ø–µ—Ü–∏–∞–ª—å–Ω–æ–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ',
    message='–¢–µ–∫—Å—Ç –ø–∏—Å—å–º–∞',
    recipient_list=custom_recipients
)
```

## –ú–∏–≥—Ä–∞—Ü–∏–∏

–°–∏—Å—Ç–µ–º–∞ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç —Å–ª–µ–¥—É—é—â–∏–µ –º–∏–≥—Ä–∞—Ü–∏–∏:

- `0013_add_instruction_journal_email_templates` - –°–æ–∑–¥–∞–Ω–∏–µ —Ç–∏–ø–æ–≤ —à–∞–±–ª–æ–Ω–æ–≤
- `0014_add_wysiwyg_to_email_body` - –î–æ–±–∞–≤–ª–µ–Ω–∏–µ CKEditor
- `0015_migrate_to_ckeditor5` - –ú–∏–≥—Ä–∞—Ü–∏—è –Ω–∞ CKEditor5
- `0016_add_email_templates` - –°–æ–∑–¥–∞–Ω–∏–µ –º–æ–¥–µ–ª–µ–π EmailTemplate –∏ EmailTemplateType
- `0017_update_notifications_verbose_names` - –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ verbose_name
- `0018_remove_instruction_journal_fields` - –£–¥–∞–ª–µ–Ω–∏–µ —Å—Ç–∞—Ä—ã—Ö –ø–æ–ª–µ–π

## TODO / –ü–ª–∞–Ω—ã —Ä–∞–∑–≤–∏—Ç–∏—è

- [x] –ò—Å—Ç–æ—Ä–∏—è –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–Ω—ã—Ö –ø–∏—Å–µ–º (—Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ —á–µ—Ä–µ–∑ –ª–æ–≥–∏ MedicalNotificationSendLog, KeyDeadlineSendLog, InstructionJournalSendLog)
- [x] –ö–Ω–æ–ø–∫–∏ —Ä—É—á–Ω–æ–≥–æ –∑–∞–ø—É—Å–∫–∞ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π –∏–∑ –∞–¥–º–∏–Ω–∫–∏ (—Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ –¥–ª—è –º–µ–¥–æ—Å–º–æ—Ç—Ä–æ–≤ –∏ –∫–ª—é—á–µ–≤—ã—Ö –º–µ—Ä–æ–ø—Ä–∏—è—Ç–∏–π)
- [ ] –ü–æ–¥–¥–µ—Ä–∂–∫–∞ –≤–ª–æ–∂–µ–Ω–∏–π –≤ email
- [ ] –ü–ª–∞–Ω–∏—Ä–æ–≤—â–∏–∫ –æ—Ç–ø—Ä–∞–≤–∫–∏ (–æ—Ç–ª–æ–∂–µ–Ω–Ω–∞—è –æ—Ç–ø—Ä–∞–≤–∫–∞)
- [ ] –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –¥–æ—Å—Ç–∞–≤–∫–∏ (–æ—Ç–∫—Ä—ã—Ç–∏—è, –∫–ª–∏–∫–∏)
- [ ] –ü–æ–¥–¥–µ—Ä–∂–∫–∞ –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö —è–∑—ã–∫–æ–≤ –≤ —à–∞–±–ª–æ–Ω–∞—Ö
- [ ] –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å –≤–Ω–µ—à–Ω–∏–º–∏ email-—Å–µ—Ä–≤–∏—Å–∞–º–∏ (SendGrid, Mailgun)
- [ ] –®–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ –ø–∞—Ä–æ–ª–µ–π –≤ –ë–î

## –°–≤—è–∑–∞–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã

### –ú–æ–¥–µ–ª–∏
- `deadline_control/models/email_settings.py` - –ú–æ–¥–µ–ª—å –Ω–∞—Å—Ç—Ä–æ–µ–∫ SMTP
- `deadline_control/models/email_template.py` - –ú–æ–¥–µ–ª—å —à–∞–±–ª–æ–Ω–æ–≤
- `deadline_control/models/medical_send_log.py` - –õ–æ–≥–∏ –º–µ–¥–∏—Ü–∏–Ω—Å–∫–∏—Ö —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π
- `deadline_control/models/key_deadline_send_log.py` - –õ–æ–≥–∏ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π –æ –∫–ª—é—á–µ–≤—ã—Ö –º–µ—Ä–æ–ø—Ä–∏—è—Ç–∏—è—Ö
- `directory/models/subdivision_email.py` - Email –ø–æ–¥—Ä–∞–∑–¥–µ–ª–µ–Ω–∏–π

### –ê–¥–º–∏–Ω–∫–∞
- `deadline_control/admin/email_settings.py` - –ê–¥–º–∏–Ω–∫–∞ –Ω–∞—Å—Ç—Ä–æ–µ–∫ SMTP (—Å –∫–Ω–æ–ø–∫–æ–π "–¢–µ—Å—Ç email")
- `deadline_control/admin/email_template.py` - –ê–¥–º–∏–Ω–∫–∞ —à–∞–±–ª–æ–Ω–æ–≤
- `deadline_control/admin/medical_examination.py` - –ê–¥–º–∏–Ω–∫–∞ –º–µ–¥–æ—Å–º–æ—Ç—Ä–æ–≤ (—Å –∫–Ω–æ–ø–∫–æ–π –æ—Ç–ø—Ä–∞–≤–∫–∏ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π)
- `deadline_control/admin/key_deadline.py` - –ê–¥–º–∏–Ω–∫–∞ –∫–ª—é—á–µ–≤—ã—Ö —Å—Ä–æ–∫–æ–≤ (—Å –∫–Ω–æ–ø–∫–æ–π –æ—Ç–ø—Ä–∞–≤–∫–∏ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π)
- `deadline_control/admin/medical_send_log.py` - –ê–¥–º–∏–Ω–∫–∞ –ª–æ–≥–æ–≤ –º–µ–¥–∏—Ü–∏–Ω—Å–∫–∏—Ö —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π
- `deadline_control/admin/key_deadline_send_log.py` - –ê–¥–º–∏–Ω–∫–∞ –ª–æ–≥–æ–≤ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π –æ –∫–ª—é—á–µ–≤—ã—Ö –º–µ—Ä–æ–ø—Ä–∏—è—Ç–∏—è—Ö

### Management –∫–æ–º–∞–Ω–¥—ã
- `deadline_control/management/commands/send_medical_notifications.py` - –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è —Ä–∞—Å—Å—ã–ª–∫–∞ –º–µ–¥–∏—Ü–∏–Ω—Å–∫–∏—Ö —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π
- `deadline_control/management/commands/send_key_deadline_notifications.py` - –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è —Ä–∞—Å—Å—ã–ª–∫–∞ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π –æ –∫–ª—é—á–µ–≤—ã—Ö –º–µ—Ä–æ–ø—Ä–∏—è—Ç–∏—è—Ö

### –£—Ç–∏–ª–∏—Ç—ã
- `directory/utils/email_recipients.py` - –°–∏—Å—Ç–µ–º–∞ —Å–±–æ—Ä–∞ –ø–æ–ª—É—á–∞—Ç–µ–ª–µ–π (—Ç—Ä—ë—Ö—É—Ä–æ–≤–Ω–µ–≤–∞—è)
