# Git Workflow –¥–ª—è —Ä–∞–±–æ—Ç—ã –Ω–∞ production —Å–µ—Ä–≤–µ—Ä–µ

## üéØ –û—Å–Ω–æ–≤–Ω–æ–π –ø—Ä–∏–Ω—Ü–∏–ø

**–í–ê–ñ–ù–û:** –ù–∞ production —Å–µ—Ä–≤–µ—Ä–µ **–ù–ï –î–ï–õ–ê–Æ–¢–°–Ø –∫–æ–º–º–∏—Ç—ã –∫–æ–¥–∞!**

Production —Å–µ—Ä–≤–µ—Ä - —ç—Ç–æ **—Ç–æ–ª—å–∫–æ –ø—Ä–∏—ë–º–Ω–∏–∫** –∏–∑–º–µ–Ω–µ–Ω–∏–π –∏–∑ –æ—Å–Ω–æ–≤–Ω–æ–≥–æ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è.

## üìä –ü—Ä–∞–≤–∏–ª—å–Ω–∞—è —Å—Ö–µ–º–∞ —Ä–∞–±–æ—Ç—ã

```
–õ–æ–∫–∞–ª—å–Ω—ã–π –∫–æ–º–ø—å—é—Ç–µ—Ä (Development)
    ‚Üì –∫–æ–¥, —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ
    ‚Üì git commit
    ‚Üì git push
GitHub/GitLab (Origin)
    ‚Üì git pull
Production —Å–µ—Ä–≤–µ—Ä (192.168.37.10)
    ‚Üì –ø—Ä–∏–º–µ–Ω–µ–Ω–∏–µ –∏–∑–º–µ–Ω–µ–Ω–∏–π
    ‚Üì –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫ —Å–µ—Ä–≤–∏—Å–æ–≤
–†–∞–±–æ—Ç–∞—é—â–µ–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ (https://pot.by)
```

## üîÑ Workflow –ø–æ —à–∞–≥–∞–º

### 1. –†–∞–∑—Ä–∞–±–æ—Ç–∫–∞ –Ω–∞ –ª–æ–∫–∞–ª—å–Ω–æ–π –º–∞—à–∏–Ω–µ

```bash
# –ù–∞ –≤–∞—à–µ–º –∫–æ–º–ø—å—é—Ç–µ—Ä–µ (Windows/Mac/Linux)
cd /path/to/local/OT_online

# –°–æ–∑–¥–∞—Ç—å –≤–µ—Ç–∫—É –¥–ª—è —Ñ–∏—á–∏
git checkout -b feature/new-feature

# –í–Ω–µ—Å—Ç–∏ –∏–∑–º–µ–Ω–µ–Ω–∏—è
# ... —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Ñ–∞–π–ª–æ–≤ ...

# –ó–∞–∫–æ–º–º–∏—Ç–∏—Ç—å
git add .
git commit -m "–î–æ–±–∞–≤–ª–µ–Ω–∞ –Ω–æ–≤–∞—è —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å"

# –ó–∞–ø—É—à–∏—Ç—å –≤ GitHub
git push origin feature/new-feature
```

### 2. Code Review –∏ –º–µ—Ä–¥–∂ (–µ—Å–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç–µ)

```bash
# –°–æ–∑–¥–∞—Ç—å Pull Request –Ω–∞ GitHub
# –ü–æ—Å–ª–µ —Ä–µ–≤—å—é - —Å–º–µ—Ä–∂–∏—Ç—å –≤ main

# –ò–ª–∏ —Å—Ä–∞–∑—É –≤ main (–¥–ª—è –ø—Ä–æ—Å—Ç—ã—Ö –ø—Ä–æ–µ–∫—Ç–æ–≤)
git checkout main
git merge feature/new-feature
git push origin main
```

### 3. –î–µ–ø–ª–æ–π –Ω–∞ production

```bash
# –ù–∞ production —Å–µ—Ä–≤–µ—Ä–µ (192.168.37.10)
cd /home/django/webapps/potby

# –ü–æ–ª—É—á–∏—Ç—å –∏–∑–º–µ–Ω–µ–Ω–∏—è
git fetch origin

# –ü–æ—Å–º–æ—Ç—Ä–µ—Ç—å, —á—Ç–æ –∏–∑–º–µ–Ω–∏–ª–æ—Å—å
git log HEAD..origin/main --oneline

# –ü—Ä–∏–º–µ–Ω–∏—Ç—å –∏–∑–º–µ–Ω–µ–Ω–∏—è
git pull origin main

# –ü—Ä–∏–º–µ–Ω–∏—Ç—å –º–∏–≥—Ä–∞—Ü–∏–∏ (–µ—Å–ª–∏ –µ—Å—Ç—å)
source venv/bin/activate
python manage.py migrate --settings=settings_prod

# –°–æ–±—Ä–∞—Ç—å —Å—Ç–∞—Ç–∏–∫—É (–µ—Å–ª–∏ –∏–∑–º–µ–Ω–∏–ª–∞—Å—å)
python manage.py collectstatic --noinput --settings=settings_prod

# –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç—å —Å–µ—Ä–≤–µ—Ä
./reload_gunicorn.sh
```

## üö´ –ß—Ç–æ –ù–ï –¥–µ–ª–∞—Ç—å –Ω–∞ production

1. **–ù–ï –∫–æ–º–º–∏—Ç–∏—Ç—å –∫–æ–¥:**
   ```bash
   # ‚ùå –ù–ï –î–ï–õ–ê–ô–¢–ï –¢–ê–ö:
   git add .
   git commit -m "–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –Ω–∞ production"
   git push
   ```

2. **–ù–ï —Å–æ–∑–¥–∞–≤–∞—Ç—å –≤–µ—Ç–∫–∏ –Ω–∞ production**

3. **–ù–ï —Ä–∞–∑—Ä–∞–±–∞—Ç—ã–≤–∞—Ç—å –∫–æ–¥ –Ω–∞–ø—Ä—è–º—É—é –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ**

4. **–ù–ï –¥–µ–ª–∞—Ç—å rebase/merge –Ω–∞ production**

## ‚úÖ –ß—Ç–æ –ú–û–ñ–ù–û –¥–µ–ª–∞—Ç—å –Ω–∞ production

1. **git pull** - –ø–æ–ª—É—á–∞—Ç—å –∏–∑–º–µ–Ω–µ–Ω–∏—è –∏–∑ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è

2. **git fetch** - –ø—Ä–æ–≤–µ—Ä—è—Ç—å –Ω–∞–ª–∏—á–∏–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–π

3. **git log** - —Å–º–æ—Ç—Ä–µ—Ç—å –∏—Å—Ç–æ—Ä–∏—é

4. **git diff** - —Å–º–æ—Ç—Ä–µ—Ç—å –∏–∑–º–µ–Ω–µ–Ω–∏—è

5. **git status** - –ø—Ä–æ–≤–µ—Ä—è—Ç—å —Å–æ—Å—Ç–æ—è–Ω–∏–µ

6. **git stash** - –≤—Ä–µ–º–µ–Ω–Ω–æ —Å–æ—Ö—Ä–∞–Ω–∏—Ç—å –ª–æ–∫–∞–ª—å–Ω—ã–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è (—Å–º. –Ω–∏–∂–µ)

## üîß –†–∞–±–æ—Ç–∞ —Å –ª–æ–∫–∞–ª—å–Ω—ã–º–∏ –∏–∑–º–µ–Ω–µ–Ω–∏—è–º–∏ –Ω–∞ production

–ò–Ω–æ–≥–¥–∞ –Ω–∞ production –ø–æ—è–≤–ª—è—é—Ç—Å—è –ª–æ–∫–∞–ª—å–Ω—ã–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è (–∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è, –ª–æ–≥–∏ –∏ —Ç.–¥.).

### –í–∞—Ä–∏–∞–Ω—Ç 1: –°–æ—Ö—Ä–∞–Ω–∏—Ç—å –∏ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–∏—Ç—å (.gitignore)

**–†–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –¥–ª—è:**
- `.env` —Ñ–∞–π–ª–æ–≤
- –õ–æ–≥–æ–≤
- –í—Ä–µ–º–µ–Ω–Ω—ã—Ö —Ñ–∞–π–ª–æ–≤
- Production-—Å–ø–µ—Ü–∏—Ñ–∏—á–Ω—ã—Ö –∫–æ–Ω—Ñ–∏–≥–æ–≤

–î–æ–±–∞–≤—å—Ç–µ –≤ `.gitignore`:
```gitignore
# Production specific
.env
logs/
*.log
run/
*.pyc
__pycache__/
```

### –í–∞—Ä–∏–∞–Ω—Ç 2: Git stash (–¥–ª—è –≤—Ä–µ–º–µ–Ω–Ω—ã—Ö –∏–∑–º–µ–Ω–µ–Ω–∏–π)

```bash
# –°–æ—Ö—Ä–∞–Ω–∏—Ç—å –ª–æ–∫–∞–ª—å–Ω—ã–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è
git stash save "–í—Ä–µ–º–µ–Ω–Ω—ã–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è –Ω–∞ production"

# –ü–æ–ª—É—á–∏—Ç—å –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è
git pull origin main

# –í–µ—Ä–Ω—É—Ç—å –ª–æ–∫–∞–ª—å–Ω—ã–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è
git stash pop

# –ï—Å–ª–∏ –∫–æ–Ω—Ñ–ª–∏–∫—Ç - —Ä–∞–∑—Ä–µ—à–∏—Ç—å –≤—Ä—É—á–Ω—É—é
```

### –í–∞—Ä–∏–∞–Ω—Ç 3: –û—Ç–∫–∞—Ç–∏—Ç—å –ª–æ–∫–∞–ª—å–Ω—ã–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è

```bash
# –ü–æ—Å–º–æ—Ç—Ä–µ—Ç—å –∏–∑–º–µ–Ω—ë–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã
git status

# –û—Ç–∫–∞—Ç–∏—Ç—å –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–π —Ñ–∞–π–ª
git restore –ø—É—Ç—å/–∫/—Ñ–∞–π–ª—É

# –û—Ç–∫–∞—Ç–∏—Ç—å –í–°–ï –∏–∑–º–µ–Ω–µ–Ω–∏—è (–û–°–¢–û–†–û–ñ–ù–û!)
git restore .
```

### –í–∞—Ä–∏–∞–Ω—Ç 4: –°–æ–∑–¥–∞—Ç—å –æ—Ç–¥–µ–ª—å–Ω—É—é –≤–µ—Ç–∫—É (–¥–ª—è —ç–∫—Å—Ç—Ä–µ–Ω–Ω—ã—Ö hotfix)

```bash
# –¢–û–õ–¨–ö–û –≤ –∫—Ä–∞–π–Ω–µ–º —Å–ª—É—á–∞–µ!
git checkout -b hotfix/emergency-fix

# –í–Ω–µ—Å—Ç–∏ –∏–∑–º–µ–Ω–µ–Ω–∏—è
git add —Ñ–∞–π–ª
git commit -m "Emergency fix"

# –ó–∞–ø—É—à–∏—Ç—å –¥–ª—è –¥–∞–ª—å–Ω–µ–π—à–µ–≥–æ review
git push origin hotfix/emergency-fix

# –í–µ—Ä–Ω—É—Ç—å—Å—è –Ω–∞ main
git checkout main
```

## üìÅ –§–∞–π–ª—ã –∫–æ—Ç–æ—Ä—ã–µ –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å –≤ .gitignore

–ü—Ä–æ–≤–µ—Ä—å—Ç–µ `.gitignore` –Ω–∞ –Ω–∞–ª–∏—á–∏–µ:

```gitignore
# Python
*.py[cod]
__pycache__/
*.so
.Python
venv/
env/
ENV/

# Django
*.log
db.sqlite3
db.sqlite3-journal
/staticfiles/
/media/ # –∏–ª–∏ —Ç–æ–ª—å–∫–æ /media/temp/

# Production specific
.env
.env.prod
logs/
run/
*.pid

# IDE
.vscode/
.idea/
*.swp
*.swo

# OS
.DS_Store
Thumbs.db

# Temporary files
*.tmp
*.bak
*.backup
utility_scripts/

# Uploads (–µ—Å–ª–∏ –±–æ–ª—å—à–∏–µ)
media/uploads/

# Cache
*.cache
.pytest_cache/
```

## üîë –ù–∞—Å—Ç—Ä–æ–π–∫–∞ SSH –∫–ª—é—á–µ–π –¥–ª—è GitHub

–î–ª—è –±–µ—Å–ø–∞—Ä–æ–ª—å–Ω–æ–≥–æ –¥–æ—Å—Ç—É–ø–∞ –∫ GitHub:

### 1. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –Ω–∞–ª–∏—á–∏–µ SSH –∫–ª—é—á–∞

```bash
ls -la ~/.ssh/id_*
```

### 2. –°–æ–∑–¥–∞—Ç—å SSH –∫–ª—é—á (–µ—Å–ª–∏ –Ω–µ—Ç)

```bash
ssh-keygen -t ed25519 -C "dev@ot-online.local"
# –ù–∞–∂–∏–º–∞–π—Ç–µ Enter –¥–ª—è defaults
```

### 3. –î–æ–±–∞–≤–∏—Ç—å –∫–ª—é—á –≤ ssh-agent

```bash
eval "$(ssh-agent -s)"
ssh-add ~/.ssh/id_ed25519
```

### 4. –°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –ø—É–±–ª–∏—á–Ω—ã–π –∫–ª—é—á

```bash
cat ~/.ssh/id_ed25519.pub
# –°–∫–æ–ø–∏—Ä—É–π—Ç–µ –≤—ã–≤–æ–¥
```

### 5. –î–æ–±–∞–≤–∏—Ç—å –Ω–∞ GitHub

1. –ó–∞–π–¥–∏—Ç–µ –Ω–∞ https://github.com/settings/keys
2. New SSH key
3. –í—Å—Ç–∞–≤—å—Ç–µ —Å–∫–æ–ø–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –∫–ª—é—á
4. Save

### 6. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ

```bash
ssh -T git@github.com
# –î–æ–ª–∂–Ω–æ –±—ã—Ç—å: Hi username! You've successfully authenticated...
```

### 7. –ò–∑–º–µ–Ω–∏—Ç—å remote –Ω–∞ SSH (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)

```bash
# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Ç–µ–∫—É—â–∏–π remote
git remote -v

# –ò–∑–º–µ–Ω–∏—Ç—å –Ω–∞ SSH (–¥–ª—è –±–µ—Å–ø–∞—Ä–æ–ª—å–Ω–æ–≥–æ –¥–æ—Å—Ç—É–ø–∞)
git remote set-url origin git@github.com:minpaint/OT_online.git

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å
git remote -v
```

## üìã –¢–∏–ø–∏—á–Ω—ã–µ —Å—Ü–µ–Ω–∞—Ä–∏–∏

### –°—Ü–µ–Ω–∞—Ä–∏–π 1: –û–±—ã—á–Ω—ã–π –¥–µ–ø–ª–æ–π

```bash
cd /home/django/webapps/potby
git pull origin main
python manage.py migrate --settings=settings_prod
python manage.py collectstatic --noinput --settings=settings_prod
./reload_gunicorn.sh
```

### –°—Ü–µ–Ω–∞—Ä–∏–π 2: –ï—Å—Ç—å –ª–æ–∫–∞–ª—å–Ω—ã–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è

```bash
# –°–æ—Ö—Ä–∞–Ω–∏—Ç—å –ª–æ–∫–∞–ª—å–Ω—ã–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è
git stash

# –ü–æ–ª—É—á–∏—Ç—å –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è
git pull origin main

# –í–µ—Ä–Ω—É—Ç—å –∏–∑–º–µ–Ω–µ–Ω–∏—è
git stash pop

# –ü—Ä–∏–º–µ–Ω–∏—Ç—å –º–∏–≥—Ä–∞—Ü–∏–∏ –∏ –ø–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç—å
python manage.py migrate --settings=settings_prod
./reload_gunicorn.sh
```

### –°—Ü–µ–Ω–∞—Ä–∏–π 3: –û—Ç–∫–∞—Ç–∏—Ç—å –∫ –ø—Ä–µ–¥—ã–¥—É—â–µ–π –≤–µ—Ä—Å–∏–∏

```bash
# –ü–æ—Å–º–æ—Ç—Ä–µ—Ç—å –∫–æ–º–º–∏—Ç—ã
git log --oneline -10

# –û—Ç–∫–∞—Ç–∏—Ç—å –∫ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–º—É –∫–æ–º–º–∏—Ç—É
git reset --hard <commit-hash>

# –í–ù–ò–ú–ê–ù–ò–ï: —ç—Ç–æ —É–¥–∞–ª–∏—Ç –≤—Å–µ –ª–æ–∫–∞–ª—å–Ω—ã–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è!

# –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç—å
./reload_gunicorn.sh
```

### –°—Ü–µ–Ω–∞—Ä–∏–π 4: –ü—Ä–æ–≤–µ—Ä–∏—Ç—å, —á—Ç–æ –∏–∑–º–µ–Ω–∏–ª–æ—Å—å –ø–µ—Ä–µ–¥ pull

```bash
# –ü–æ–ª—É—á–∏—Ç—å –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –±–µ–∑ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏—è
git fetch origin

# –ü–æ—Å–º–æ—Ç—Ä–µ—Ç—å –∏–∑–º–µ–Ω–µ–Ω–∏—è
git log HEAD..origin/main

# –ü–æ—Å–º–æ—Ç—Ä–µ—Ç—å diff
git diff HEAD..origin/main

# –ï—Å–ª–∏ –≤—Å—ë –û–ö - –ø—Ä–∏–º–µ–Ω–∏—Ç—å
git pull origin main
```

## üîç –ü–æ–ª–µ–∑–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã Git

```bash
# –¢–µ–∫—É—â–∏–π —Å—Ç–∞—Ç—É—Å
git status

# –ò—Å—Ç–æ—Ä–∏—è –∫–æ–º–º–∏—Ç–æ–≤
git log --oneline -20

# –ò–∑–º–µ–Ω–µ–Ω–∏—è –≤ —Ñ–∞–π–ª–µ
git diff —Ñ–∞–π–ª

# –ö—Ç–æ –∏–∑–º–µ–Ω–∏–ª —Ñ–∞–π–ª
git blame —Ñ–∞–π–ª

# –ü–æ—Å–º–æ—Ç—Ä–µ—Ç—å –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–π –∫–æ–º–º–∏—Ç
git show <commit-hash>

# –°–ø–∏—Å–æ–∫ –≤–µ—Ç–æ–∫
git branch -a

# –¢–µ–∫—É—â–∞—è –≤–µ—Ç–∫–∞
git branch --show-current

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å remote
git remote -v

# –û—á–∏—Å—Ç–∏—Ç—å –Ω–µ–æ—Ç—Å–ª–µ–∂–∏–≤–∞–µ–º—ã–µ —Ñ–∞–π–ª—ã (–û–°–¢–û–†–û–ñ–ù–û!)
git clean -fd
```

## ‚ö†Ô∏è –í–∞–∂–Ω—ã–µ –ø—Ä–∞–≤–∏–ª–∞

1. **–í—Å–µ–≥–¥–∞ –¥–µ–ª–∞–π—Ç–µ backup –ø–µ—Ä–µ–¥ git pull:**
   ```bash
   # –°–æ–∑–¥–∞—Ç—å snapshot –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö
   pg_dump ot_online > backup_$(date +%Y%m%d_%H%M%S).sql
   ```

2. **–ü—Ä–æ–≤–µ—Ä—è–π—Ç–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è –ø–µ—Ä–µ–¥ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏–µ–º:**
   ```bash
   git fetch
   git log HEAD..origin/main
   ```

3. **–ï—Å–ª–∏ —á—Ç–æ-—Ç–æ –ø–æ—à–ª–æ –Ω–µ —Ç–∞–∫ - –æ—Ç–∫–∞—Ç–∏—Ç–µ:**
   ```bash
   git reset --hard HEAD@{1}
   ```

4. **–ù–ï –ò–°–ü–û–õ–¨–ó–£–ô–¢–ï git push –Ω–∞ production!**

5. **–•—Ä–∞–Ω–∏—Ç–µ production-—Å–ø–µ—Ü–∏—Ñ–∏—á–Ω—ã–µ —Ñ–∞–π–ª—ã –≤–Ω–µ Git:**
   - `.env` - –≤ .gitignore
   - –õ–æ–≥–∏ - –≤ .gitignore
   - Upload'—ã - –≤ .gitignore

## üöÄ –°–∫—Ä–∏–ø—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ –¥–µ–ø–ª–æ—è

–°–æ–∑–¥–∞–π—Ç–µ —Ñ–∞–π–ª `deploy_from_git.sh`:

```bash
#!/bin/bash
# –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –¥–µ–ø–ª–æ–π –∏–∑ Git

set -e

echo "üöÄ –î–µ–ø–ª–æ–π OT_online –∏–∑ Git"
echo "======================================"

# 1. –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ç–µ–∫—É—â–µ–π –≤–µ—Ç–∫–∏
BRANCH=$(git branch --show-current)
if [ "$BRANCH" != "main" ]; then
    echo "‚ö†Ô∏è  –í—ã –Ω–µ –Ω–∞ –≤–µ—Ç–∫–µ main (—Ç–µ–∫—É—â–∞—è: $BRANCH)"
    read -p "–ü—Ä–æ–¥–æ–ª–∂–∏—Ç—å? (y/n) " -n 1 -r
    echo
    if [[ ! $REPLY =~ ^[Yy]$ ]]; then
        exit 1
    fi
fi

# 2. –°–æ—Ö—Ä–∞–Ω–∏—Ç—å –ª–æ–∫–∞–ª—å–Ω—ã–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è
if [[ $(git status --porcelain) ]]; then
    echo "üíæ –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –ª–æ–∫–∞–ª—å–Ω—ã—Ö –∏–∑–º–µ–Ω–µ–Ω–∏–π..."
    git stash save "Auto-stash before deploy $(date +%Y%m%d_%H%M%S)"
fi

# 3. –ü–æ–ª—É—á–∏—Ç—å –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è
echo "üì• –ü–æ–ª—É—á–µ–Ω–∏–µ –∏–∑–º–µ–Ω–µ–Ω–∏–π –∏–∑ Git..."
git fetch origin

# 4. –ü–æ–∫–∞–∑–∞—Ç—å –∏–∑–º–µ–Ω–µ–Ω–∏—è
echo ""
echo "üìã –ò–∑–º–µ–Ω–µ–Ω–∏—è –¥–ª—è –ø—Ä–∏–º–µ–Ω–µ–Ω–∏—è:"
git log HEAD..origin/main --oneline
echo ""

# 5. –ü—Ä–∏–º–µ–Ω–∏—Ç—å –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è
echo "‚¨áÔ∏è  –ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–π..."
git pull origin main

# 6. –í–µ—Ä–Ω—É—Ç—å –ª–æ–∫–∞–ª—å–Ω—ã–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è
if git stash list | grep -q "Auto-stash"; then
    echo "‚ôªÔ∏è  –í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ –ª–æ–∫–∞–ª—å–Ω—ã—Ö –∏–∑–º–µ–Ω–µ–Ω–∏–π..."
    git stash pop || echo "‚ö†Ô∏è  –ö–æ–Ω—Ñ–ª–∏–∫—Ç –ø—Ä–∏ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–∏, –ø—Ä–æ–≤–µ—Ä—å—Ç–µ –≤—Ä—É—á–Ω—É—é"
fi

# 7. –í–∏—Ä—Ç—É–∞–ª—å–Ω–æ–µ –æ–∫—Ä—É–∂–µ–Ω–∏–µ
echo "üêç –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π..."
source venv/bin/activate
pip install -r requirements.txt -q

# 8. –ú–∏–≥—Ä–∞—Ü–∏–∏
echo "üóÑÔ∏è  –ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ –º–∏–≥—Ä–∞—Ü–∏–π..."
python manage.py migrate --settings=settings_prod

# 9. –°—Ç–∞—Ç–∏–∫–∞
echo "üì¶ –°–±–æ—Ä–∫–∞ —Å—Ç–∞—Ç–∏–∫–∏..."
python manage.py collectstatic --noinput --settings=settings_prod

# 10. –ü–µ—Ä–µ–∑–∞–ø—É—Å–∫
echo "üîÑ –ü–µ—Ä–µ–∑–∞–ø—É—Å–∫ —Å–µ—Ä–≤–µ—Ä–∞..."
./reload_gunicorn.sh

echo ""
echo "======================================"
echo "‚úÖ –î–µ–ø–ª–æ–π –∑–∞–≤–µ—Ä—à—ë–Ω —É—Å–ø–µ—à–Ω–æ!"
echo "======================================"
```

–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ:
```bash
chmod +x deploy_from_git.sh
./deploy_from_git.sh
```

## üìö –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ

- **–î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è Git:** https://git-scm.com/doc
- **GitHub SSH:** https://docs.github.com/en/authentication/connecting-to-github-with-ssh
- **Git Workflow:** https://www.atlassian.com/git/tutorials/comparing-workflows

## üÜò –ü–æ–º–æ—â—å

### –ü—Ä–æ–±–ª–µ–º–∞: Permission denied (GitHub)

**–†–µ—à–µ–Ω–∏–µ:** –ù–∞—Å—Ç—Ä–æ–π—Ç–µ SSH –∫–ª—é—á–∏ (—Å–º. –≤—ã—à–µ) –∏–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ HTTPS —Å —Ç–æ–∫–µ–Ω–æ–º

### –ü—Ä–æ–±–ª–µ–º–∞: –ö–æ–Ω—Ñ–ª–∏–∫—Ç—ã –ø—Ä–∏ git pull

**–†–µ—à–µ–Ω–∏–µ:**
```bash
# –ü–æ—Å–º–æ—Ç—Ä–µ—Ç—å –∫–æ–Ω—Ñ–ª–∏–∫—Ç—ã
git status

# –†–∞–∑—Ä–µ—à–∏—Ç—å –≤—Ä—É—á–Ω—É—é
# ... —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Ñ–∞–π–ª–æ–≤ ...

# –î–æ–±–∞–≤–∏—Ç—å —Ä–∞–∑—Ä–µ—à—ë–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã
git add —Ñ–∞–π–ª

# –ó–∞–≤–µ—Ä—à–∏—Ç—å merge
git commit
```

### –ü—Ä–æ–±–ª–µ–º–∞: –°–ª—É—á–∞–π–Ω–æ –∑–∞–∫–æ–º–º–∏—Ç–∏–ª–∏ –Ω–∞ production

**–†–µ—à–µ–Ω–∏–µ:**
```bash
# –û—Ç–∫–∞—Ç–∏—Ç—å –ø–æ—Å–ª–µ–¥–Ω–∏–π –∫–æ–º–º–∏—Ç (—Å–æ—Ö—Ä–∞–Ω–∏–≤ –∏–∑–º–µ–Ω–µ–Ω–∏—è)
git reset --soft HEAD^

# –ò–ª–∏ —É–¥–∞–ª–∏—Ç—å –∫–æ–º–º–∏—Ç –ø–æ–ª–Ω–æ—Å—Ç—å—é
git reset --hard HEAD^

# –ù–ï –ü–£–®–¨–¢–ï –Ω–∞ origin!
```

---

**–ü–æ–º–Ω–∏—Ç–µ:** Production —Å–µ—Ä–≤–µ—Ä - —ç—Ç–æ **—Ç–æ–ª—å–∫–æ –ø—Ä–∏—ë–º–Ω–∏–∫** –∏–∑–º–µ–Ω–µ–Ω–∏–π, –∞ –Ω–µ –º–µ—Å—Ç–æ –¥–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏!
