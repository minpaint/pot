{% extends "admin/change_form.html" %}
{% load i18n admin_urls %}

{% block object-tools-items %}
    {% if original %}
    <li>
        <a href="{% url 'admin:position_copy_reference_norms' original.pk %}" class="historylink" onclick="return confirm('–í—ã —É–≤–µ—Ä–µ–Ω—ã, —á—Ç–æ —Ö–æ—Ç–∏—Ç–µ –ø–æ–¥—Ç—è–Ω—É—Ç—å —ç—Ç–∞–ª–æ–Ω–Ω—ã–µ –Ω–æ—Ä–º—ã –°–ò–ó –¥–ª—è —ç—Ç–æ–π –¥–æ–ª–∂–Ω–æ—Å—Ç–∏? –≠—Ç–æ –º–æ–∂–µ—Ç –æ–±–Ω–æ–≤–∏—Ç—å —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–µ –Ω–æ—Ä–º—ã.');">
            üîÑ –ü–æ–¥—Ç—è–Ω—É—Ç—å —ç—Ç–∞–ª–æ–Ω–Ω—ã–µ –Ω–æ—Ä–º—ã –°–ò–ó
        </a>
    </li>

    {% if has_medical_factors %}
    <li>
        <a href="#medical_factors" class="historylink">
            ü©∫ –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –Ω–æ—Ä–º–∞–º–∏ –º–µ–¥–æ—Å–º–æ—Ç—Ä–æ–≤
        </a>
    </li>
    {% endif %}
    {% endif %}
    {{ block.super }}
{% endblock %}

{% block after_related_objects %}
    {{ block.super }}
    {% if has_medical_factors %}
    <div class="medical-factors-info module">
        <h2 id="medical_factors">–ü–µ—Ä–µ–æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è –Ω–æ—Ä–º –º–µ–¥–æ—Å–º–æ—Ç—Ä–æ–≤</h2>
        <div class="description">
            <p>–î–ª—è —ç—Ç–æ–π –¥–æ–ª–∂–Ω–æ—Å—Ç–∏ –∏–º–µ—é—Ç—Å—è –ø–µ—Ä–µ–æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã—Ö –Ω–æ—Ä–º –º–µ–¥–æ—Å–º–æ—Ç—Ä–æ–≤.
            –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –∏–Ω–ª–∞–π–Ω-—Ñ–æ—Ä–º—É –≤—ã—à–µ –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –ø–µ—Ä–µ–æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è–º–∏ –∏–ª–∏ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –Ω–æ–≤—ã—Ö.</p>

            <p>–ï—Å–ª–∏ –Ω—É–∂–Ω–æ –≤–µ—Ä–Ω—É—Ç—å—Å—è –∫ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–º –Ω–æ—Ä–º–∞–º, —É–¥–∞–ª–∏—Ç–µ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏–µ –ø–µ—Ä–µ–æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è.</p>
        </div>
    </div>
    <style>
        .medical-factors-info {
            margin-top: 20px;
            border-left: 4px solid #dc3545;
            padding-left: 16px;
        }
        .medical-factors-info h2 {
            color: #dc3545;
        }
    </style>
    {% endif %}

    {# JavaScript –¥–ª—è –ø–µ—Ä–µ–º–µ—â–µ–Ω–∏—è —Å–µ–∫—Ü–∏–π –ø–µ—Ä–µ–æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è –∫ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏–º –∏–Ω–ª–∞–π–Ω–∞–º #}
    <script>
    (function() {
        'use strict';

        function moveOverrideSections() {
            // –ü–µ—Ä–µ–º–µ—â–∞–µ–º —Å–µ–∫—Ü–∏—é –ø–µ—Ä–µ–æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è –°–ò–ó –ø–µ—Ä–µ–¥ –∏–Ω–ª–∞–π–Ω–æ–º –°–ò–ó
            var sizOverrideFieldset = document.querySelector('.siz-override-section');
            var sizInline = document.querySelector('#siz_norms-group');

            if (sizOverrideFieldset && sizInline) {
                var sizModule = sizOverrideFieldset.closest('.module');
                if (sizModule) {
                    sizInline.parentNode.insertBefore(sizModule, sizInline);
                }
            }

            // –ü–µ—Ä–µ–º–µ—â–∞–µ–º —Å–µ–∫—Ü–∏—é –ø–µ—Ä–µ–æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è –º–µ–¥–æ—Å–º–æ—Ç—Ä–æ–≤ –ø–µ—Ä–µ–¥ –∏–Ω–ª–∞–π–Ω–æ–º –º–µ–¥–æ—Å–º–æ—Ç—Ä–æ–≤
            var medicalOverrideFieldset = document.querySelector('.medical-override-section');
            var medicalInline = document.querySelector('#medical_factors-group');

            if (medicalOverrideFieldset && medicalInline) {
                var medicalModule = medicalOverrideFieldset.closest('.module');
                if (medicalModule) {
                    medicalInline.parentNode.insertBefore(medicalModule, medicalInline);
                }
            }
        }

        // –í—ã–ø–æ–ª–Ω—è–µ–º –ø–æ—Å–ª–µ –ø–æ–ª–Ω–æ–π –∑–∞–≥—Ä—É–∑–∫–∏ DOM
        if (document.readyState === 'loading') {
            document.addEventListener('DOMContentLoaded', moveOverrideSections);
        } else {
            moveOverrideSections();
        }
    })();
    </script>
{% endblock %}