{% extends "admin/change_list.html" %}
{% load static %}

{% block content %}
<div id="content-main">
  <div class="object-tools">
    <a href="{% url 'admin:directory_position_add' %}" class="addlink">
      –î–æ–±–∞–≤–∏—Ç—å
    </a>
    <a href="{% url 'admin:directory_position_import' %}" class="addlink" style="background-position: 0 -96px;">
      üì• –ò–º–ø–æ—Ä—Ç
    </a>
    <a href="{% url 'admin:directory_position_export' %}" class="addlink" style="background-position: 0 -96px;">
      üì§ –≠–∫—Å–ø–æ—Ä—Ç
    </a>
  </div>
  <form id="changelist-form" method="post"
        {% if cl.formset and cl.formset.is_multipart %} enctype="multipart/form-data"{% endif %}
        novalidate>
    {% csrf_token %}
    {% if action_form and actions_on_top and cl.show_admin_actions %}
      <div class="actions">
        {% for field in action_form %}
          {% if field.label %}<label>{{ field.label }}</label>{% endif %}
          {{ field }}
        {% endfor %}
        <button type="submit" class="button" title="–í—ã–ø–æ–ª–Ω–∏—Ç—å –≤—ã–±—Ä–∞–Ω–Ω–æ–µ –¥–µ–π—Å—Ç–≤–∏–µ">–í—ã–ø–æ–ª–Ω–∏—Ç—å</button>
        <span class="action-counter" style="display: none;">0 –∏–∑ {{ cl.result_count }} –≤—ã–±—Ä–∞–Ω–æ</span>
      </div>
    {% endif %}

    <div class="tree-controls">
      <button type="button" class="tree-btn expand-all">‚Üì –†–∞–∑–≤–µ—Ä–Ω—É—Ç—å –≤—Å–µ</button>
      <button type="button" class="tree-btn collapse-all">‚Üë –°–≤–µ—Ä–Ω—É—Ç—å –≤—Å–µ</button>
      <div class="tree-search-container">
        <input type="text" class="tree-search" placeholder="üîç –ü–æ–∏—Å–∫ –ø–æ –¥–µ—Ä–µ–≤—É...">
      </div>
    </div>

    <div class="results">
      <table id="result_list">
        <thead>
          <tr>
            <th class="column-checkbox"><input type="checkbox" id="select-all"></th>
            <th class="column-name">–ù–ê–ò–ú–ï–ù–û–í–ê–ù–ò–ï</th>
            <th class="column-roles">–ê–¢–†–ò–ë–£–¢–´/–†–û–õ–ò</th>
            <th class="column-actions">–î–ï–ô–°–¢–í–ò–Ø</th>
          </tr>
        </thead>
        <tbody>
          {% for org, org_data in tree.items %}
            <tr class="tree-row" data-level="0" data-node-id="org_{{ org.id }}">
              <td class="field-checkbox"></td>
              <td class="field-name">
                <button type="button" class="toggle-btn" data-state="expanded">[-]</button>
                <span class="tree-icon">{{ tree_settings.icons.organization|default:"üè¢" }}</span>
                <strong>{{ org_data.name }}</strong>
              </td>
              <td class="field-roles"></td>
              <td class="field-actions"></td>
            </tr>

            {# –≠–ª–µ–º–µ–Ω—Ç—ã –±–µ–∑ subdivision #}
            {% for item in org_data.items %}
              <tr class="tree-row" data-level="1" data-parent-id="org_{{ org.id }}">
                <td class="field-checkbox">
                  <input type="checkbox" name="_selected_action" value="{{ item.object.pk }}" class="action-select">
                </td>
                <td class="field-name">
                  <span class="tree-icon">{{ item.additional_data.profession_icon|default:"üëî" }}</span>
                  <a href="{% url 'admin:directory_position_change' item.object.pk %}">
                    {{ item.name }}
                  </a>
                </td>
                <td class="field-roles">
                  {% if item.additional_data.has_siz_norms %}
                    <span class="badge badge-{{ item.additional_data.siz_norms_type }}" title="{{ item.additional_data.siz_norms_title }}">üõ°Ô∏è</span>
                  {% endif %}

                  {% if item.additional_data.has_medical_norms %}
                    <span class="badge badge-{{ item.additional_data.medical_norms_type }}" title="{{ item.additional_data.medical_norms_title }}">üè•</span>
                  {% endif %}

                  {% if item.additional_data.is_responsible_for_safety %}
                    <span class="position-attribute" title="–û—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω—ã–π –∑–∞ –û–¢">üî∞</span>
                  {% endif %}

                  {% if item.additional_data.can_be_internship_leader %}
                    <span class="position-attribute" title="–ú–æ–∂–µ—Ç –±—ã—Ç—å —Ä—É–∫–æ–≤–æ–¥–∏—Ç–µ–ª–µ–º —Å—Ç–∞–∂–∏—Ä–æ–≤–∫–∏">üéì</span>
                  {% endif %}

                  {% if item.additional_data.is_electrical_personnel %}
                    <span class="position-attribute" title="–≠–ª–µ–∫—Ç—Ä–æ—Ç–µ—Ö–Ω–∏—á–µ—Å–∫–∏–π –ø–µ—Ä—Å–æ–Ω–∞–ª">‚ö°</span>
                  {% endif %}

                  {# –ú–æ–∂–µ—Ç –ø–æ–¥–ø–∏—Å—ã–≤–∞—Ç—å —Ä–∞—Å–ø–æ—Ä—è–∂–µ–Ω–∏—è #}
                  {% if item.additional_data.can_sign_orders %}
                    <span class="position-attribute" title="–ú–æ–∂–µ—Ç –ø–æ–¥–ø–∏—Å—ã–≤–∞—Ç—å —Ä–∞—Å–ø–æ—Ä—è–∂–µ–Ω–∏—è">üìù</span>
                  {% endif %}

                  {# –ì—Ä—É–ø–ø–∞ –ø–æ —ç–ª–µ–∫—Ç—Ä–æ–±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ #}
                  {% with g=item.additional_data.electrical_group %}
                  {% if g %}
                    <span class="position-attribute" title="–ì—Ä—É–ø–ø–∞ {{ g }} –ø–æ –≠–ë">
                      {% if g == "I" %}1Ô∏è‚É£{% elif g == "II" %}2Ô∏è‚É£
                      {% elif g == "III" %}3Ô∏è‚É£{% elif g == "IV" %}4Ô∏è‚É£
                      {% elif g == "V" %}5Ô∏è‚É£{% endif %}
                    </span>
                  {% endif %}
                  {% endwith %}

                  {# –†–æ–ª–∏ –≤ –∫–æ–º–∏—Å—Å–∏—è—Ö #}
                  {% for role in item.additional_data.commission_roles %}
                    <span class="position-attribute" title="{{ role.role_display }} –≤ –∫–æ–º–∏—Å—Å–∏–∏ '{{ role.commission_name }}'">
                      {% if role.role == 'chairman' %}üó≥Ô∏è
                      {% elif role.role == 'secretary' %}üìù
                      {% else %}üë•{% endif %}
                    </span>
                  {% endfor %}

                  {# –£–ø—Ä–∞–≤–ª—è–µ—Ç —Å–ª—É–∂–µ–±–Ω—ã–º –∞–≤—Ç–æ–º–æ–±–∏–ª–µ–º #}
                  {% if item.additional_data.drives_company_vehicle %}
                    <span class="position-attribute" title="–£–ø—Ä–∞–≤–ª—è–µ—Ç —Å–ª—É–∂–µ–±–Ω—ã–º –∞–≤—Ç–æ–º–æ–±–∏–ª–µ–º">üöó</span>
                  {% endif %}

                  {# –ò–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ –ø–æ –û–¢ #}
                  {% if item.additional_data.instruction_numbers %}
                    <span class="instruction-tag" title="–ò–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ –ø–æ –æ—Ö—Ä–∞–Ω–µ —Ç—Ä—É–¥–∞">{{ item.additional_data.instruction_numbers }}</span>
                  {% else %}
                    <span class="instruction-missing" title="–ò–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ –ø–æ –æ—Ö—Ä–∞–Ω–µ —Ç—Ä—É–¥–∞ –Ω–µ –∑–∞–ø–æ–ª–Ω–µ–Ω—ã">‚ö†Ô∏è –Ω–µ—Ç –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–π</span>
                  {% endif %}
                </td>
                <td class="field-actions">
                  <a href="{% url 'admin:directory_position_change' item.object.pk %}" class="edit-link">‚úèÔ∏è</a>
                  <a href="{% url 'admin:directory_position_delete' item.object.pk %}" class="delete-link">üóëÔ∏è</a>
                  <a href="{% url 'admin:directory_position_history' item.object.pk %}" class="history-link">üìã</a>
                </td>
              </tr>
            {% endfor %}

            {# –ü–æ–¥—Ä–∞–∑–¥–µ–ª–µ–Ω–∏—è #}
            {% for sub, sub_data in org_data.subdivisions.items %}
              <tr class="tree-row" data-level="1" data-parent-id="org_{{ org.id }}" data-node-id="sub_{{ sub.id }}">
                <td class="field-checkbox"></td>
                <td class="field-name">
                  <button type="button" class="toggle-btn" data-state="expanded">[-]</button>
                  <span class="tree-icon">{{ tree_settings.icons.subdivision|default:"üè≠" }}</span>
                  {{ sub_data.name }}
                </td>
                <td class="field-roles"></td>
                <td class="field-actions"></td>
              </tr>

              {# –≠–ª–µ–º–µ–Ω—Ç—ã –±–µ–∑ department #}
              {% for item in sub_data.items %}
                <tr class="tree-row" data-level="2" data-parent-id="sub_{{ sub.id }}">
                  <td class="field-checkbox">
                    <input type="checkbox" name="_selected_action" value="{{ item.object.pk }}" class="action-select">
                  </td>
                  <td class="field-name">
                    <span class="tree-icon">{{ item.additional_data.profession_icon|default:"üëî" }}</span>
                    <a href="{% url 'admin:directory_position_change' item.object.pk %}">
                      {{ item.name }}
                    </a>
                  </td>
                  <td class="field-roles">
                    {% if item.additional_data.has_siz_norms %}
                      <span class="badge badge-{{ item.additional_data.siz_norms_type }}" title="{{ item.additional_data.siz_norms_title }}">üõ°Ô∏è</span>
                    {% endif %}

                    {% if item.additional_data.has_medical_norms %}
                      <span class="badge badge-{{ item.additional_data.medical_norms_type }}" title="{{ item.additional_data.medical_norms_title }}">üè•</span>
                    {% endif %}

                    {% if item.additional_data.is_responsible_for_safety %}
                      <span class="position-attribute" title="–û—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω—ã–π –∑–∞ –û–¢">üî∞</span>
                    {% endif %}

                    {% if item.additional_data.can_be_internship_leader %}
                      <span class="position-attribute" title="–ú–æ–∂–µ—Ç –±—ã—Ç—å —Ä—É–∫–æ–≤–æ–¥–∏—Ç–µ–ª–µ–º —Å—Ç–∞–∂–∏—Ä–æ–≤–∫–∏">üéì</span>
                    {% endif %}

                    {% if item.additional_data.is_electrical_personnel %}
                      <span class="position-attribute" title="–≠–ª–µ–∫—Ç—Ä–æ—Ç–µ—Ö–Ω–∏—á–µ—Å–∫–∏–π –ø–µ—Ä—Å–æ–Ω–∞–ª">‚ö°</span>
                    {% endif %}

                    {# –ú–æ–∂–µ—Ç –ø–æ–¥–ø–∏—Å—ã–≤–∞—Ç—å —Ä–∞—Å–ø–æ—Ä—è–∂–µ–Ω–∏—è #}
                    {% if item.additional_data.can_sign_orders %}
                      <span class="position-attribute" title="–ú–æ–∂–µ—Ç –ø–æ–¥–ø–∏—Å—ã–≤–∞—Ç—å —Ä–∞—Å–ø–æ—Ä—è–∂–µ–Ω–∏—è">üìù</span>
                    {% endif %}

                    {# –ì—Ä—É–ø–ø–∞ –ø–æ —ç–ª–µ–∫—Ç—Ä–æ–±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ #}
                    {% with g=item.additional_data.electrical_group %}
                    {% if g %}
                      <span class="position-attribute" title="–ì—Ä—É–ø–ø–∞ {{ g }} –ø–æ –≠–ë">
                        {% if g == "I" %}1Ô∏è‚É£{% elif g == "II" %}2Ô∏è‚É£
                        {% elif g == "III" %}3Ô∏è‚É£{% elif g == "IV" %}4Ô∏è‚É£
                        {% elif g == "V" %}5Ô∏è‚É£{% endif %}
                      </span>
                    {% endif %}
                    {% endwith %}

                    {# –†–æ–ª–∏ –≤ –∫–æ–º–∏—Å—Å–∏—è—Ö #}
                    {% for role in item.additional_data.commission_roles %}
                      <span class="position-attribute" title="{{ role.role_display }} –≤ –∫–æ–º–∏—Å—Å–∏–∏ '{{ role.commission_name }}'">
                        {% if role.role == 'chairman' %}üó≥Ô∏è
                        {% elif role.role == 'secretary' %}üìù
                        {% else %}üë•{% endif %}
                      </span>
                    {% endfor %}

                    {# –£–ø—Ä–∞–≤–ª—è–µ—Ç —Å–ª—É–∂–µ–±–Ω—ã–º –∞–≤—Ç–æ–º–æ–±–∏–ª–µ–º #}
                    {% if item.additional_data.drives_company_vehicle %}
                      <span class="position-attribute" title="–£–ø—Ä–∞–≤–ª—è–µ—Ç —Å–ª—É–∂–µ–±–Ω—ã–º –∞–≤—Ç–æ–º–æ–±–∏–ª–µ–º">üöó</span>
                    {% endif %}

                    {# –ò–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ –ø–æ –û–¢ #}
                    {% if item.additional_data.instruction_numbers %}
                      <span class="instruction-tag" title="–ò–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ –ø–æ –æ—Ö—Ä–∞–Ω–µ —Ç—Ä—É–¥–∞">{{ item.additional_data.instruction_numbers }}</span>
                    {% else %}
                      <span class="instruction-missing" title="–ò–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ –ø–æ –æ—Ö—Ä–∞–Ω–µ —Ç—Ä—É–¥–∞ –Ω–µ –∑–∞–ø–æ–ª–Ω–µ–Ω—ã">‚ö†Ô∏è –Ω–µ—Ç –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–π</span>
                    {% endif %}
                  </td>
                  <td class="field-actions">
                    <a href="{% url 'admin:directory_position_change' item.object.pk %}" class="edit-link">‚úèÔ∏è</a>
                    <a href="{% url 'admin:directory_position_delete' item.object.pk %}" class="delete-link">üóëÔ∏è</a>
                    <a href="{% url 'admin:directory_position_history' item.object.pk %}" class="history-link">üìã</a>
                  </td>
                </tr>
              {% endfor %}

              {# –û—Ç–¥–µ–ª—ã #}
              {% for dept, dept_data in sub_data.departments.items %}
                <tr class="tree-row" data-level="2" data-parent-id="sub_{{ sub.id }}" data-node-id="dept_{{ dept.id }}">
                  <td class="field-checkbox"></td>
                  <td class="field-name">
                    <button type="button" class="toggle-btn" data-state="expanded">[-]</button>
                    <span class="tree-icon">{{ tree_settings.icons.department|default:"üìÇ" }}</span>
                    {{ dept_data.name }}
                  </td>
                  <td class="field-roles"></td>
                  <td class="field-actions"></td>
                </tr>

                {% for item in dept_data.items %}
                  <tr class="tree-row" data-level="3" data-parent-id="dept_{{ dept.id }}">
                    <td class="field-checkbox">
                      <input type="checkbox" name="_selected_action" value="{{ item.object.pk }}" class="action-select">
                    </td>
                    <td class="field-name">
                      <span class="tree-icon">{{ item.additional_data.profession_icon|default:"üëî" }}</span>
                      <a href="{% url 'admin:directory_position_change' item.object.pk %}">
                        {{ item.name }}
                      </a>
                    </td>
                    <td class="field-roles">
                      {% if item.additional_data.has_siz_norms %}
                        <span class="badge badge-{{ item.additional_data.siz_norms_type }}" title="{{ item.additional_data.siz_norms_title }}">üõ°Ô∏è</span>
                      {% endif %}

                      {% if item.additional_data.has_medical_norms %}
                        <span class="badge badge-{{ item.additional_data.medical_norms_type }}" title="{{ item.additional_data.medical_norms_title }}">üè•</span>
                      {% endif %}

                      {% if item.additional_data.is_responsible_for_safety %}
                        <span class="position-attribute" title="–û—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω—ã–π –∑–∞ –û–¢">üî∞</span>
                      {% endif %}

                      {% if item.additional_data.can_be_internship_leader %}
                        <span class="position-attribute" title="–ú–æ–∂–µ—Ç –±—ã—Ç—å —Ä—É–∫–æ–≤–æ–¥–∏—Ç–µ–ª–µ–º —Å—Ç–∞–∂–∏—Ä–æ–≤–∫–∏">üéì</span>
                      {% endif %}

                      {% if item.additional_data.is_electrical_personnel %}
                        <span class="position-attribute" title="–≠–ª–µ–∫—Ç—Ä–æ—Ç–µ—Ö–Ω–∏—á–µ—Å–∫–∏–π –ø–µ—Ä—Å–æ–Ω–∞–ª">‚ö°</span>
                      {% endif %}

                      {# –ú–æ–∂–µ—Ç –ø–æ–¥–ø–∏—Å—ã–≤–∞—Ç—å —Ä–∞—Å–ø–æ—Ä—è–∂–µ–Ω–∏—è #}
                      {% if item.additional_data.can_sign_orders %}
                        <span class="position-attribute" title="–ú–æ–∂–µ—Ç –ø–æ–¥–ø–∏—Å—ã–≤–∞—Ç—å —Ä–∞—Å–ø–æ—Ä—è–∂–µ–Ω–∏—è">üìù</span>
                      {% endif %}

                      {# –ì—Ä—É–ø–ø–∞ –ø–æ —ç–ª–µ–∫—Ç—Ä–æ–±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ #}
                      {% with g=item.additional_data.electrical_group %}
                      {% if g %}
                        <span class="position-attribute" title="–ì—Ä—É–ø–ø–∞ {{ g }} –ø–æ –≠–ë">
                          {% if g == "I" %}1Ô∏è‚É£{% elif g == "II" %}2Ô∏è‚É£
                          {% elif g == "III" %}3Ô∏è‚É£{% elif g == "IV" %}4Ô∏è‚É£
                          {% elif g == "V" %}5Ô∏è‚É£{% endif %}
                        </span>
                      {% endif %}
                      {% endwith %}

                      {# –†–æ–ª–∏ –≤ –∫–æ–º–∏—Å—Å–∏—è—Ö #}
                      {% for role in item.additional_data.commission_roles %}
                        <span class="position-attribute" title="{{ role.role_display }} –≤ –∫–æ–º–∏—Å—Å–∏–∏ '{{ role.commission_name }}'">
                          {% if role.role == 'chairman' %}üó≥Ô∏è
                          {% elif role.role == 'secretary' %}üìù
                          {% else %}üë•{% endif %}
                        </span>
                      {% endfor %}

                      {# –£–ø—Ä–∞–≤–ª—è–µ—Ç —Å–ª—É–∂–µ–±–Ω—ã–º –∞–≤—Ç–æ–º–æ–±–∏–ª–µ–º #}
                      {% if item.additional_data.drives_company_vehicle %}
                        <span class="position-attribute" title="–£–ø—Ä–∞–≤–ª—è–µ—Ç —Å–ª—É–∂–µ–±–Ω—ã–º –∞–≤—Ç–æ–º–æ–±–∏–ª–µ–º">üöó</span>
                      {% endif %}

                      {# –ò–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ –ø–æ –û–¢ #}
                      {% if item.additional_data.instruction_numbers %}
                        <span class="instruction-tag" title="–ò–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ –ø–æ –æ—Ö—Ä–∞–Ω–µ —Ç—Ä—É–¥–∞">{{ item.additional_data.instruction_numbers }}</span>
                      {% else %}
                        <span class="instruction-missing" title="–ò–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ –ø–æ –æ—Ö—Ä–∞–Ω–µ —Ç—Ä—É–¥–∞ –Ω–µ –∑–∞–ø–æ–ª–Ω–µ–Ω—ã">‚ö†Ô∏è –Ω–µ—Ç –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–π</span>
                      {% endif %}
                    </td>
                    <td class="field-actions">
                      <a href="{% url 'admin:directory_position_change' item.object.pk %}" class="edit-link">‚úèÔ∏è</a>
                      <a href="{% url 'admin:directory_position_delete' item.object.pk %}" class="delete-link">üóëÔ∏è</a>
                      <a href="{% url 'admin:directory_position_history' item.object.pk %}" class="history-link">üìã</a>
                    </td>
                  </tr>
                {% endfor %}
              {% endfor %}
            {% endfor %}
          {% endfor %}
        </tbody>
      </table>
    </div>
  </form>
</div>

{# –ü–ª–∞–≤–∞—é—â–∞—è –∫–Ω–æ–ø–∫–∞ –¥–ª—è –∑–∞–ø—É—Å–∫–∞ –¥–µ–π—Å—Ç–≤–∏—è "–ó–∞–ø–æ–ª–Ω–∏—Ç—å –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ –∏–∑ —ç—Ç–∞–ª–æ–Ω–∞" #}
<button type="button" id="floating-copy-instructions" title="–ó–∞–ø–æ–ª–Ω–∏—Ç—å –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ –∏–∑ —ç—Ç–∞–ª–æ–Ω–∞">
  üîÑ –ó–∞–ø–æ–ª–Ω–∏—Ç—å –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ –∏–∑ —ç—Ç–∞–ª–æ–Ω–∞
</button>

<script>
  (function() {
    const btn = document.getElementById('floating-copy-instructions');
    const form = document.getElementById('changelist-form');
    if (!btn || !form) return;

    // –ù–∞—Ö–æ–¥–∏–º —Å–µ–ª–µ–∫—Ç –¥–µ–π—Å—Ç–≤–∏–π; –æ–Ω –µ—Å—Ç—å —Ç–æ–ª—å–∫–æ –µ—Å–ª–∏ –∞–¥–º–∏–Ω –æ—Ç—Ä–∏—Å–æ–≤–∞–ª –±–ª–æ–∫ –¥–µ–π—Å—Ç–≤–∏–π
    const actionSelect = form.querySelector('select[name="action"]');
    if (!actionSelect) return;

    btn.addEventListener('click', function() {
      const checked = Array.from(form.querySelectorAll('input.action-select:checked'));
      if (checked.length !== 1) {
        alert('–í—ã–±–µ—Ä–∏—Ç–µ —Ä–æ–≤–Ω–æ –æ–¥–Ω—É –¥–æ–ª–∂–Ω–æ—Å—Ç—å-—ç—Ç–∞–ª–æ–Ω –¥–ª—è –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏—è –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–π.');
        return;
      }

      actionSelect.value = 'copy_instructions_from_template';
      form.submit();
    });
  })();
</script>
{% endblock %}

{% block extrahead %}
  {{ block.super }}
  <link rel="stylesheet" href="{% static 'admin/css/tree_view.css' %}">
  <script src="{% static 'admin/js/tree_view.js' %}"></script>
  <script src="{% static 'admin/js/tree_search.js' %}"></script>
  <style>
    /* –°—Ç–∏–ª–∏ –¥–ª—è –±–µ–π–¥–∂–µ–π –∏ –∏–∫–æ–Ω–æ–∫ */
    .badge {
      display: inline-block;
      margin-right: 5px;
      font-size: 16px;
    }

    /* –ü–µ—Ä–µ–æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω—ã–µ –Ω–æ—Ä–º—ã - —Å –≤—ã–¥–µ–ª–µ–Ω–∏–µ–º */
    .badge-custom {
      background-color: #28a745; /* –ó–µ–ª–µ–Ω—ã–π */
      color: white;
      padding: 3px 7px;
      font-size: 12px;
      font-weight: 600;
      line-height: 1;
      border-radius: 10px;
    }

    /* –°—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–µ –Ω–æ—Ä–º—ã - –±–µ–∑ –≤—ã–¥–µ–ª–µ–Ω–∏—è */
    .badge-reference {
      background-color: transparent;
      color: inherit;
    }

    .position-attribute {
      display: inline-block;
      margin-right: 5px;
      font-size: 16px;
    }

    /* –£–≤–µ–ª–∏—á–∏–≤–∞–µ–º —Ä–∞–∑–º–µ—Ä –∏–∫–æ–Ω–æ–∫ –ø—Ä–æ—Ñ–µ—Å—Å–∏–π */
    .tree-icon {
      display: inline-block;
      margin-right: 8px;
      font-size: 18px;
    }

    .instruction-tag {
      display: inline-block;
      margin-left: 6px;
      padding: 2px 6px;
      background: #eef7ff;
      border: 1px solid #c6defa;
      border-radius: 8px;
      font-size: 12px;
      color: #0b5394;
      white-space: nowrap;
    }

    .instruction-missing {
      display: inline-block;
      margin-left: 6px;
      padding: 2px 6px;
      background: #fff4e5;
      border: 1px solid #f5c78a;
      border-radius: 8px;
      font-size: 12px;
      color: #9c5700;
      white-space: nowrap;
    }

    #floating-copy-instructions {
      position: fixed;
      right: 24px;
      bottom: 24px;
      z-index: 1000;
      background: #0b5394;
      color: #fff;
      border: none;
      border-radius: 10px;
      padding: 12px 16px;
      font-size: 14px;
      box-shadow: 0 6px 16px rgba(0, 0, 0, 0.2);
      cursor: pointer;
    }

    #floating-copy-instructions:hover {
      background: #0d63b5;
    }
  </style>
{% endblock %}
